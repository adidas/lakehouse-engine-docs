<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>lakehouse_engine.transformers.filters</title>
            <link rel="icon" href="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#000000;background-color:#f1efef;border-color:#f1f1f1;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:150%;overflow:auto;margin-bottom:1rem;}.pdoc table th, .pdoc table td{padding:12px 13px;border:1px solid var(--accent2);}.pdoc table th{font-weight:600;}</style>
    <style>/*! custom.css */</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../transformers.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lakehouse_engine.transformers</a>

            <img src="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Filters">Filters</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Filters.incremental_filter">incremental_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Filters.expression_filter">expression_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Filters.column_filter_exp">column_filter_exp</a>
                        </li>
                        <li>
                                <a class="function" href="#Filters.drop_duplicate_rows">drop_duplicate_rows</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>Lakehouse Engine v1.20.1</footer>

</div>
    </nav>
    <main class="pdoc">
    <section class="module-info">

                <h1 class="modulename">
<a href="./../../lakehouse_engine.html">lakehouse_engine</a><wbr>.<a href="./../transformers.html">transformers</a><wbr>.filters    </h1>

                <div class="docstring"><p>Module containing the filters transformers.</p>
</div>

                    <input id="mod-filters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                    <label class="view-source-button" for="mod-filters-view-source"><span>View Source</span></label>

                    <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;Module containing the filters transformers.&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">DataFrame</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">lakehouse_engine.transformers.watermarker</span> <span class="kn">import</span> <span class="n">Watermarker</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">lakehouse_engine.utils.logging_handler</span> <span class="kn">import</span> <span class="n">LoggingHandler</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">Filters</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class containing the filters transformers.&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="n">_logger</span> <span class="o">=</span> <span class="n">LoggingHandler</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="k">def</span> <span class="nf">incremental_filter</span><span class="p">(</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>        <span class="n">input_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>        <span class="n">increment_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>        <span class="n">increment_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>        <span class="n">increment_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>        <span class="n">greater_or_equal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Incrementally Filter a certain dataframe given an increment logic.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">        This logic can either be an increment value or an increment dataframe from</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">        which the get the latest value from. By default, the operator for the</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">        filtering process is greater or equal to cover cases where we receive late</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        arriving data not cover in a previous load. You can change greater_or_equal</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">        to false to use greater, when you trust the source will never output more data</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        with the increment after you have load the data (e.g., you will never load</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        data until the source is still dumping data, which may cause you to get an</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        incomplete picture of the last arrived data).</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        Args:</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">            input_col: input column name</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">            increment_value: value to which to filter the data, considering the</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">                provided input_Col.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">            increment_df: a dataframe to get the increment value from.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">                you either specify this or the increment_value (this takes precedence).</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">                This is a good approach to get the latest value from a given dataframe</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">                that was read and apply that value as filter here. In this way you can</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">                perform incremental loads based on the last value of a given dataframe</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">                (e.g., table or file based). Can be used together with the</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">                get_max_value transformer to accomplish these incremental based loads.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">                See our append load feature tests  to see how to provide an acon for</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">                incremental loads, taking advantage of the scenario explained here.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">            increment_col: name of the column from which to get the increment</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">                value from (when using increment_df approach). This assumes there&#39;s</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">                only one row in the increment_df, reason why is a good idea to use</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">                together with the get_max_value transformer. Defaults to &quot;latest&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">                because that&#39;s the default output column name provided by the</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">                get_max_value transformer.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">            greater_or_equal: if filtering should be done by also including the</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">                increment value or not (useful for scenarios where you are performing</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">                increment loads but still want to include data considering the increment</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">                value, and not only values greater than that increment... examples may</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">                include scenarios where you already loaded data including those values,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">                but the source produced more data containing those values).</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">                Defaults to false.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        Returns:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>            <span class="k">if</span> <span class="n">increment_df</span><span class="p">:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>                <span class="k">if</span> <span class="n">greater_or_equal</span><span class="p">:</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>                        <span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">increment_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">increment_col</span><span class="p">]</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>                    <span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>                        <span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">increment_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">increment_col</span><span class="p">]</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>                    <span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>                <span class="k">if</span> <span class="n">greater_or_equal</span><span class="p">:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">increment_value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">increment_value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="k">def</span> <span class="nf">expression_filter</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a dataframe based on an expression.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        Args:</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">            exp: filter expression.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        Returns:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">column_filter_exp</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a dataframe&#39;s columns based on a list of SQL expressions.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        Args:</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">            exp: column filter expressions.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        Returns:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="o">*</span><span class="n">exp</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">drop_duplicate_rows</span><span class="p">(</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="n">cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">watermarker</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Drop duplicate rows using spark function dropDuplicates().</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">        This transformer can be used with or without arguments.</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        The provided argument needs to be a list of columns.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        For example: [“Name”,”VAT”] will drop duplicate records within</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        &quot;Name&quot; and &quot;VAT&quot; columns.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        If the transformer is used without providing any columns list or providing</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        an empty list, such as [] the result will be the same as using</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        the distinct() pyspark function. If the watermark dict is present it will</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">        ensure that the drop operation will apply to rows within the watermark timeline</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        window.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        Args:</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">            cols: column names.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">            watermarker: properties to apply watermarker to the transformer.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        Returns:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="k">if</span> <span class="n">watermarker</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">Watermarker</span><span class="o">.</span><span class="n">with_watermark</span><span class="p">(</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                    <span class="n">watermarker</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">],</span> <span class="n">watermarker</span><span class="p">[</span><span class="s2">&quot;watermarking_time&quot;</span><span class="p">]</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                <span class="p">)(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">()</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>                <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


    </section>
        <section id="Filters">
                    <input id="Filters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Filters</span>:

                <label class="view-source-button" for="Filters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Filters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Filters-12"><a href="#Filters-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">Filters</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Filters-13"><a href="#Filters-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class containing the filters transformers.&quot;&quot;&quot;</span>
</span><span id="Filters-14"><a href="#Filters-14"><span class="linenos"> 14</span></a>
</span><span id="Filters-15"><a href="#Filters-15"><span class="linenos"> 15</span></a>    <span class="n">_logger</span> <span class="o">=</span> <span class="n">LoggingHandler</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span>
</span><span id="Filters-16"><a href="#Filters-16"><span class="linenos"> 16</span></a>
</span><span id="Filters-17"><a href="#Filters-17"><span class="linenos"> 17</span></a>    <span class="nd">@classmethod</span>
</span><span id="Filters-18"><a href="#Filters-18"><span class="linenos"> 18</span></a>    <span class="k">def</span> <span class="nf">incremental_filter</span><span class="p">(</span>
</span><span id="Filters-19"><a href="#Filters-19"><span class="linenos"> 19</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="Filters-20"><a href="#Filters-20"><span class="linenos"> 20</span></a>        <span class="n">input_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="Filters-21"><a href="#Filters-21"><span class="linenos"> 21</span></a>        <span class="n">increment_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Filters-22"><a href="#Filters-22"><span class="linenos"> 22</span></a>        <span class="n">increment_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Filters-23"><a href="#Filters-23"><span class="linenos"> 23</span></a>        <span class="n">increment_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
</span><span id="Filters-24"><a href="#Filters-24"><span class="linenos"> 24</span></a>        <span class="n">greater_or_equal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Filters-25"><a href="#Filters-25"><span class="linenos"> 25</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters-26"><a href="#Filters-26"><span class="linenos"> 26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Incrementally Filter a certain dataframe given an increment logic.</span>
</span><span id="Filters-27"><a href="#Filters-27"><span class="linenos"> 27</span></a>
</span><span id="Filters-28"><a href="#Filters-28"><span class="linenos"> 28</span></a><span class="sd">        This logic can either be an increment value or an increment dataframe from</span>
</span><span id="Filters-29"><a href="#Filters-29"><span class="linenos"> 29</span></a><span class="sd">        which the get the latest value from. By default, the operator for the</span>
</span><span id="Filters-30"><a href="#Filters-30"><span class="linenos"> 30</span></a><span class="sd">        filtering process is greater or equal to cover cases where we receive late</span>
</span><span id="Filters-31"><a href="#Filters-31"><span class="linenos"> 31</span></a><span class="sd">        arriving data not cover in a previous load. You can change greater_or_equal</span>
</span><span id="Filters-32"><a href="#Filters-32"><span class="linenos"> 32</span></a><span class="sd">        to false to use greater, when you trust the source will never output more data</span>
</span><span id="Filters-33"><a href="#Filters-33"><span class="linenos"> 33</span></a><span class="sd">        with the increment after you have load the data (e.g., you will never load</span>
</span><span id="Filters-34"><a href="#Filters-34"><span class="linenos"> 34</span></a><span class="sd">        data until the source is still dumping data, which may cause you to get an</span>
</span><span id="Filters-35"><a href="#Filters-35"><span class="linenos"> 35</span></a><span class="sd">        incomplete picture of the last arrived data).</span>
</span><span id="Filters-36"><a href="#Filters-36"><span class="linenos"> 36</span></a>
</span><span id="Filters-37"><a href="#Filters-37"><span class="linenos"> 37</span></a><span class="sd">        Args:</span>
</span><span id="Filters-38"><a href="#Filters-38"><span class="linenos"> 38</span></a><span class="sd">            input_col: input column name</span>
</span><span id="Filters-39"><a href="#Filters-39"><span class="linenos"> 39</span></a><span class="sd">            increment_value: value to which to filter the data, considering the</span>
</span><span id="Filters-40"><a href="#Filters-40"><span class="linenos"> 40</span></a><span class="sd">                provided input_Col.</span>
</span><span id="Filters-41"><a href="#Filters-41"><span class="linenos"> 41</span></a><span class="sd">            increment_df: a dataframe to get the increment value from.</span>
</span><span id="Filters-42"><a href="#Filters-42"><span class="linenos"> 42</span></a><span class="sd">                you either specify this or the increment_value (this takes precedence).</span>
</span><span id="Filters-43"><a href="#Filters-43"><span class="linenos"> 43</span></a><span class="sd">                This is a good approach to get the latest value from a given dataframe</span>
</span><span id="Filters-44"><a href="#Filters-44"><span class="linenos"> 44</span></a><span class="sd">                that was read and apply that value as filter here. In this way you can</span>
</span><span id="Filters-45"><a href="#Filters-45"><span class="linenos"> 45</span></a><span class="sd">                perform incremental loads based on the last value of a given dataframe</span>
</span><span id="Filters-46"><a href="#Filters-46"><span class="linenos"> 46</span></a><span class="sd">                (e.g., table or file based). Can be used together with the</span>
</span><span id="Filters-47"><a href="#Filters-47"><span class="linenos"> 47</span></a><span class="sd">                get_max_value transformer to accomplish these incremental based loads.</span>
</span><span id="Filters-48"><a href="#Filters-48"><span class="linenos"> 48</span></a><span class="sd">                See our append load feature tests  to see how to provide an acon for</span>
</span><span id="Filters-49"><a href="#Filters-49"><span class="linenos"> 49</span></a><span class="sd">                incremental loads, taking advantage of the scenario explained here.</span>
</span><span id="Filters-50"><a href="#Filters-50"><span class="linenos"> 50</span></a><span class="sd">            increment_col: name of the column from which to get the increment</span>
</span><span id="Filters-51"><a href="#Filters-51"><span class="linenos"> 51</span></a><span class="sd">                value from (when using increment_df approach). This assumes there&#39;s</span>
</span><span id="Filters-52"><a href="#Filters-52"><span class="linenos"> 52</span></a><span class="sd">                only one row in the increment_df, reason why is a good idea to use</span>
</span><span id="Filters-53"><a href="#Filters-53"><span class="linenos"> 53</span></a><span class="sd">                together with the get_max_value transformer. Defaults to &quot;latest&quot;</span>
</span><span id="Filters-54"><a href="#Filters-54"><span class="linenos"> 54</span></a><span class="sd">                because that&#39;s the default output column name provided by the</span>
</span><span id="Filters-55"><a href="#Filters-55"><span class="linenos"> 55</span></a><span class="sd">                get_max_value transformer.</span>
</span><span id="Filters-56"><a href="#Filters-56"><span class="linenos"> 56</span></a><span class="sd">            greater_or_equal: if filtering should be done by also including the</span>
</span><span id="Filters-57"><a href="#Filters-57"><span class="linenos"> 57</span></a><span class="sd">                increment value or not (useful for scenarios where you are performing</span>
</span><span id="Filters-58"><a href="#Filters-58"><span class="linenos"> 58</span></a><span class="sd">                increment loads but still want to include data considering the increment</span>
</span><span id="Filters-59"><a href="#Filters-59"><span class="linenos"> 59</span></a><span class="sd">                value, and not only values greater than that increment... examples may</span>
</span><span id="Filters-60"><a href="#Filters-60"><span class="linenos"> 60</span></a><span class="sd">                include scenarios where you already loaded data including those values,</span>
</span><span id="Filters-61"><a href="#Filters-61"><span class="linenos"> 61</span></a><span class="sd">                but the source produced more data containing those values).</span>
</span><span id="Filters-62"><a href="#Filters-62"><span class="linenos"> 62</span></a><span class="sd">                Defaults to false.</span>
</span><span id="Filters-63"><a href="#Filters-63"><span class="linenos"> 63</span></a>
</span><span id="Filters-64"><a href="#Filters-64"><span class="linenos"> 64</span></a><span class="sd">        Returns:</span>
</span><span id="Filters-65"><a href="#Filters-65"><span class="linenos"> 65</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters-66"><a href="#Filters-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters-67"><a href="#Filters-67"><span class="linenos"> 67</span></a>
</span><span id="Filters-68"><a href="#Filters-68"><span class="linenos"> 68</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters-69"><a href="#Filters-69"><span class="linenos"> 69</span></a>            <span class="k">if</span> <span class="n">increment_df</span><span class="p">:</span>
</span><span id="Filters-70"><a href="#Filters-70"><span class="linenos"> 70</span></a>                <span class="k">if</span> <span class="n">greater_or_equal</span><span class="p">:</span>
</span><span id="Filters-71"><a href="#Filters-71"><span class="linenos"> 71</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters-72"><a href="#Filters-72"><span class="linenos"> 72</span></a>                        <span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">increment_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">increment_col</span><span class="p">]</span>
</span><span id="Filters-73"><a href="#Filters-73"><span class="linenos"> 73</span></a>                    <span class="p">)</span>
</span><span id="Filters-74"><a href="#Filters-74"><span class="linenos"> 74</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Filters-75"><a href="#Filters-75"><span class="linenos"> 75</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters-76"><a href="#Filters-76"><span class="linenos"> 76</span></a>                        <span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">increment_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">increment_col</span><span class="p">]</span>
</span><span id="Filters-77"><a href="#Filters-77"><span class="linenos"> 77</span></a>                    <span class="p">)</span>
</span><span id="Filters-78"><a href="#Filters-78"><span class="linenos"> 78</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Filters-79"><a href="#Filters-79"><span class="linenos"> 79</span></a>                <span class="k">if</span> <span class="n">greater_or_equal</span><span class="p">:</span>
</span><span id="Filters-80"><a href="#Filters-80"><span class="linenos"> 80</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">increment_value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters-81"><a href="#Filters-81"><span class="linenos"> 81</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Filters-82"><a href="#Filters-82"><span class="linenos"> 82</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">increment_value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters-83"><a href="#Filters-83"><span class="linenos"> 83</span></a>
</span><span id="Filters-84"><a href="#Filters-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span><span id="Filters-85"><a href="#Filters-85"><span class="linenos"> 85</span></a>
</span><span id="Filters-86"><a href="#Filters-86"><span class="linenos"> 86</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Filters-87"><a href="#Filters-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">expression_filter</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters-88"><a href="#Filters-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a dataframe based on an expression.</span>
</span><span id="Filters-89"><a href="#Filters-89"><span class="linenos"> 89</span></a>
</span><span id="Filters-90"><a href="#Filters-90"><span class="linenos"> 90</span></a><span class="sd">        Args:</span>
</span><span id="Filters-91"><a href="#Filters-91"><span class="linenos"> 91</span></a><span class="sd">            exp: filter expression.</span>
</span><span id="Filters-92"><a href="#Filters-92"><span class="linenos"> 92</span></a>
</span><span id="Filters-93"><a href="#Filters-93"><span class="linenos"> 93</span></a><span class="sd">        Returns:</span>
</span><span id="Filters-94"><a href="#Filters-94"><span class="linenos"> 94</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters-95"><a href="#Filters-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters-96"><a href="#Filters-96"><span class="linenos"> 96</span></a>
</span><span id="Filters-97"><a href="#Filters-97"><span class="linenos"> 97</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters-98"><a href="#Filters-98"><span class="linenos"> 98</span></a>            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters-99"><a href="#Filters-99"><span class="linenos"> 99</span></a>
</span><span id="Filters-100"><a href="#Filters-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span><span id="Filters-101"><a href="#Filters-101"><span class="linenos">101</span></a>
</span><span id="Filters-102"><a href="#Filters-102"><span class="linenos">102</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Filters-103"><a href="#Filters-103"><span class="linenos">103</span></a>    <span class="k">def</span> <span class="nf">column_filter_exp</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters-104"><a href="#Filters-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a dataframe&#39;s columns based on a list of SQL expressions.</span>
</span><span id="Filters-105"><a href="#Filters-105"><span class="linenos">105</span></a>
</span><span id="Filters-106"><a href="#Filters-106"><span class="linenos">106</span></a><span class="sd">        Args:</span>
</span><span id="Filters-107"><a href="#Filters-107"><span class="linenos">107</span></a><span class="sd">            exp: column filter expressions.</span>
</span><span id="Filters-108"><a href="#Filters-108"><span class="linenos">108</span></a>
</span><span id="Filters-109"><a href="#Filters-109"><span class="linenos">109</span></a><span class="sd">        Returns:</span>
</span><span id="Filters-110"><a href="#Filters-110"><span class="linenos">110</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters-111"><a href="#Filters-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters-112"><a href="#Filters-112"><span class="linenos">112</span></a>
</span><span id="Filters-113"><a href="#Filters-113"><span class="linenos">113</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters-114"><a href="#Filters-114"><span class="linenos">114</span></a>            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="o">*</span><span class="n">exp</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters-115"><a href="#Filters-115"><span class="linenos">115</span></a>
</span><span id="Filters-116"><a href="#Filters-116"><span class="linenos">116</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span><span id="Filters-117"><a href="#Filters-117"><span class="linenos">117</span></a>
</span><span id="Filters-118"><a href="#Filters-118"><span class="linenos">118</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Filters-119"><a href="#Filters-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">drop_duplicate_rows</span><span class="p">(</span>
</span><span id="Filters-120"><a href="#Filters-120"><span class="linenos">120</span></a>        <span class="n">cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">watermarker</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Filters-121"><a href="#Filters-121"><span class="linenos">121</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters-122"><a href="#Filters-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Drop duplicate rows using spark function dropDuplicates().</span>
</span><span id="Filters-123"><a href="#Filters-123"><span class="linenos">123</span></a>
</span><span id="Filters-124"><a href="#Filters-124"><span class="linenos">124</span></a><span class="sd">        This transformer can be used with or without arguments.</span>
</span><span id="Filters-125"><a href="#Filters-125"><span class="linenos">125</span></a><span class="sd">        The provided argument needs to be a list of columns.</span>
</span><span id="Filters-126"><a href="#Filters-126"><span class="linenos">126</span></a><span class="sd">        For example: [“Name”,”VAT”] will drop duplicate records within</span>
</span><span id="Filters-127"><a href="#Filters-127"><span class="linenos">127</span></a><span class="sd">        &quot;Name&quot; and &quot;VAT&quot; columns.</span>
</span><span id="Filters-128"><a href="#Filters-128"><span class="linenos">128</span></a><span class="sd">        If the transformer is used without providing any columns list or providing</span>
</span><span id="Filters-129"><a href="#Filters-129"><span class="linenos">129</span></a><span class="sd">        an empty list, such as [] the result will be the same as using</span>
</span><span id="Filters-130"><a href="#Filters-130"><span class="linenos">130</span></a><span class="sd">        the distinct() pyspark function. If the watermark dict is present it will</span>
</span><span id="Filters-131"><a href="#Filters-131"><span class="linenos">131</span></a><span class="sd">        ensure that the drop operation will apply to rows within the watermark timeline</span>
</span><span id="Filters-132"><a href="#Filters-132"><span class="linenos">132</span></a><span class="sd">        window.</span>
</span><span id="Filters-133"><a href="#Filters-133"><span class="linenos">133</span></a>
</span><span id="Filters-134"><a href="#Filters-134"><span class="linenos">134</span></a>
</span><span id="Filters-135"><a href="#Filters-135"><span class="linenos">135</span></a><span class="sd">        Args:</span>
</span><span id="Filters-136"><a href="#Filters-136"><span class="linenos">136</span></a><span class="sd">            cols: column names.</span>
</span><span id="Filters-137"><a href="#Filters-137"><span class="linenos">137</span></a><span class="sd">            watermarker: properties to apply watermarker to the transformer.</span>
</span><span id="Filters-138"><a href="#Filters-138"><span class="linenos">138</span></a>
</span><span id="Filters-139"><a href="#Filters-139"><span class="linenos">139</span></a><span class="sd">        Returns:</span>
</span><span id="Filters-140"><a href="#Filters-140"><span class="linenos">140</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters-141"><a href="#Filters-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters-142"><a href="#Filters-142"><span class="linenos">142</span></a>
</span><span id="Filters-143"><a href="#Filters-143"><span class="linenos">143</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters-144"><a href="#Filters-144"><span class="linenos">144</span></a>            <span class="k">if</span> <span class="n">watermarker</span><span class="p">:</span>
</span><span id="Filters-145"><a href="#Filters-145"><span class="linenos">145</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">Watermarker</span><span class="o">.</span><span class="n">with_watermark</span><span class="p">(</span>
</span><span id="Filters-146"><a href="#Filters-146"><span class="linenos">146</span></a>                    <span class="n">watermarker</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">],</span> <span class="n">watermarker</span><span class="p">[</span><span class="s2">&quot;watermarking_time&quot;</span><span class="p">]</span>
</span><span id="Filters-147"><a href="#Filters-147"><span class="linenos">147</span></a>                <span class="p">)(</span><span class="n">df</span><span class="p">)</span>
</span><span id="Filters-148"><a href="#Filters-148"><span class="linenos">148</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="Filters-149"><a href="#Filters-149"><span class="linenos">149</span></a>                <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">()</span>
</span><span id="Filters-150"><a href="#Filters-150"><span class="linenos">150</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Filters-151"><a href="#Filters-151"><span class="linenos">151</span></a>                <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span id="Filters-152"><a href="#Filters-152"><span class="linenos">152</span></a>
</span><span id="Filters-153"><a href="#Filters-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


            <div class="docstring"><p>Class containing the filters transformers.</p>
</div>


                    <div id="Filters.incremental_filter" class="classattr">
                                <input id="Filters.incremental_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">incremental_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">input_col</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">increment_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">increment_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">increment_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;latest&#39;</span>,</span><span class="param">	<span class="n">greater_or_equal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Callable</span>:</span></span>

                <label class="view-source-button" for="Filters.incremental_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Filters.incremental_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Filters.incremental_filter-17"><a href="#Filters.incremental_filter-17"><span class="linenos">17</span></a>    <span class="nd">@classmethod</span>
</span><span id="Filters.incremental_filter-18"><a href="#Filters.incremental_filter-18"><span class="linenos">18</span></a>    <span class="k">def</span> <span class="nf">incremental_filter</span><span class="p">(</span>
</span><span id="Filters.incremental_filter-19"><a href="#Filters.incremental_filter-19"><span class="linenos">19</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="Filters.incremental_filter-20"><a href="#Filters.incremental_filter-20"><span class="linenos">20</span></a>        <span class="n">input_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="Filters.incremental_filter-21"><a href="#Filters.incremental_filter-21"><span class="linenos">21</span></a>        <span class="n">increment_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Filters.incremental_filter-22"><a href="#Filters.incremental_filter-22"><span class="linenos">22</span></a>        <span class="n">increment_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Filters.incremental_filter-23"><a href="#Filters.incremental_filter-23"><span class="linenos">23</span></a>        <span class="n">increment_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span><span class="p">,</span>
</span><span id="Filters.incremental_filter-24"><a href="#Filters.incremental_filter-24"><span class="linenos">24</span></a>        <span class="n">greater_or_equal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Filters.incremental_filter-25"><a href="#Filters.incremental_filter-25"><span class="linenos">25</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-26"><a href="#Filters.incremental_filter-26"><span class="linenos">26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Incrementally Filter a certain dataframe given an increment logic.</span>
</span><span id="Filters.incremental_filter-27"><a href="#Filters.incremental_filter-27"><span class="linenos">27</span></a>
</span><span id="Filters.incremental_filter-28"><a href="#Filters.incremental_filter-28"><span class="linenos">28</span></a><span class="sd">        This logic can either be an increment value or an increment dataframe from</span>
</span><span id="Filters.incremental_filter-29"><a href="#Filters.incremental_filter-29"><span class="linenos">29</span></a><span class="sd">        which the get the latest value from. By default, the operator for the</span>
</span><span id="Filters.incremental_filter-30"><a href="#Filters.incremental_filter-30"><span class="linenos">30</span></a><span class="sd">        filtering process is greater or equal to cover cases where we receive late</span>
</span><span id="Filters.incremental_filter-31"><a href="#Filters.incremental_filter-31"><span class="linenos">31</span></a><span class="sd">        arriving data not cover in a previous load. You can change greater_or_equal</span>
</span><span id="Filters.incremental_filter-32"><a href="#Filters.incremental_filter-32"><span class="linenos">32</span></a><span class="sd">        to false to use greater, when you trust the source will never output more data</span>
</span><span id="Filters.incremental_filter-33"><a href="#Filters.incremental_filter-33"><span class="linenos">33</span></a><span class="sd">        with the increment after you have load the data (e.g., you will never load</span>
</span><span id="Filters.incremental_filter-34"><a href="#Filters.incremental_filter-34"><span class="linenos">34</span></a><span class="sd">        data until the source is still dumping data, which may cause you to get an</span>
</span><span id="Filters.incremental_filter-35"><a href="#Filters.incremental_filter-35"><span class="linenos">35</span></a><span class="sd">        incomplete picture of the last arrived data).</span>
</span><span id="Filters.incremental_filter-36"><a href="#Filters.incremental_filter-36"><span class="linenos">36</span></a>
</span><span id="Filters.incremental_filter-37"><a href="#Filters.incremental_filter-37"><span class="linenos">37</span></a><span class="sd">        Args:</span>
</span><span id="Filters.incremental_filter-38"><a href="#Filters.incremental_filter-38"><span class="linenos">38</span></a><span class="sd">            input_col: input column name</span>
</span><span id="Filters.incremental_filter-39"><a href="#Filters.incremental_filter-39"><span class="linenos">39</span></a><span class="sd">            increment_value: value to which to filter the data, considering the</span>
</span><span id="Filters.incremental_filter-40"><a href="#Filters.incremental_filter-40"><span class="linenos">40</span></a><span class="sd">                provided input_Col.</span>
</span><span id="Filters.incremental_filter-41"><a href="#Filters.incremental_filter-41"><span class="linenos">41</span></a><span class="sd">            increment_df: a dataframe to get the increment value from.</span>
</span><span id="Filters.incremental_filter-42"><a href="#Filters.incremental_filter-42"><span class="linenos">42</span></a><span class="sd">                you either specify this or the increment_value (this takes precedence).</span>
</span><span id="Filters.incremental_filter-43"><a href="#Filters.incremental_filter-43"><span class="linenos">43</span></a><span class="sd">                This is a good approach to get the latest value from a given dataframe</span>
</span><span id="Filters.incremental_filter-44"><a href="#Filters.incremental_filter-44"><span class="linenos">44</span></a><span class="sd">                that was read and apply that value as filter here. In this way you can</span>
</span><span id="Filters.incremental_filter-45"><a href="#Filters.incremental_filter-45"><span class="linenos">45</span></a><span class="sd">                perform incremental loads based on the last value of a given dataframe</span>
</span><span id="Filters.incremental_filter-46"><a href="#Filters.incremental_filter-46"><span class="linenos">46</span></a><span class="sd">                (e.g., table or file based). Can be used together with the</span>
</span><span id="Filters.incremental_filter-47"><a href="#Filters.incremental_filter-47"><span class="linenos">47</span></a><span class="sd">                get_max_value transformer to accomplish these incremental based loads.</span>
</span><span id="Filters.incremental_filter-48"><a href="#Filters.incremental_filter-48"><span class="linenos">48</span></a><span class="sd">                See our append load feature tests  to see how to provide an acon for</span>
</span><span id="Filters.incremental_filter-49"><a href="#Filters.incremental_filter-49"><span class="linenos">49</span></a><span class="sd">                incremental loads, taking advantage of the scenario explained here.</span>
</span><span id="Filters.incremental_filter-50"><a href="#Filters.incremental_filter-50"><span class="linenos">50</span></a><span class="sd">            increment_col: name of the column from which to get the increment</span>
</span><span id="Filters.incremental_filter-51"><a href="#Filters.incremental_filter-51"><span class="linenos">51</span></a><span class="sd">                value from (when using increment_df approach). This assumes there&#39;s</span>
</span><span id="Filters.incremental_filter-52"><a href="#Filters.incremental_filter-52"><span class="linenos">52</span></a><span class="sd">                only one row in the increment_df, reason why is a good idea to use</span>
</span><span id="Filters.incremental_filter-53"><a href="#Filters.incremental_filter-53"><span class="linenos">53</span></a><span class="sd">                together with the get_max_value transformer. Defaults to &quot;latest&quot;</span>
</span><span id="Filters.incremental_filter-54"><a href="#Filters.incremental_filter-54"><span class="linenos">54</span></a><span class="sd">                because that&#39;s the default output column name provided by the</span>
</span><span id="Filters.incremental_filter-55"><a href="#Filters.incremental_filter-55"><span class="linenos">55</span></a><span class="sd">                get_max_value transformer.</span>
</span><span id="Filters.incremental_filter-56"><a href="#Filters.incremental_filter-56"><span class="linenos">56</span></a><span class="sd">            greater_or_equal: if filtering should be done by also including the</span>
</span><span id="Filters.incremental_filter-57"><a href="#Filters.incremental_filter-57"><span class="linenos">57</span></a><span class="sd">                increment value or not (useful for scenarios where you are performing</span>
</span><span id="Filters.incremental_filter-58"><a href="#Filters.incremental_filter-58"><span class="linenos">58</span></a><span class="sd">                increment loads but still want to include data considering the increment</span>
</span><span id="Filters.incremental_filter-59"><a href="#Filters.incremental_filter-59"><span class="linenos">59</span></a><span class="sd">                value, and not only values greater than that increment... examples may</span>
</span><span id="Filters.incremental_filter-60"><a href="#Filters.incremental_filter-60"><span class="linenos">60</span></a><span class="sd">                include scenarios where you already loaded data including those values,</span>
</span><span id="Filters.incremental_filter-61"><a href="#Filters.incremental_filter-61"><span class="linenos">61</span></a><span class="sd">                but the source produced more data containing those values).</span>
</span><span id="Filters.incremental_filter-62"><a href="#Filters.incremental_filter-62"><span class="linenos">62</span></a><span class="sd">                Defaults to false.</span>
</span><span id="Filters.incremental_filter-63"><a href="#Filters.incremental_filter-63"><span class="linenos">63</span></a>
</span><span id="Filters.incremental_filter-64"><a href="#Filters.incremental_filter-64"><span class="linenos">64</span></a><span class="sd">        Returns:</span>
</span><span id="Filters.incremental_filter-65"><a href="#Filters.incremental_filter-65"><span class="linenos">65</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters.incremental_filter-66"><a href="#Filters.incremental_filter-66"><span class="linenos">66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters.incremental_filter-67"><a href="#Filters.incremental_filter-67"><span class="linenos">67</span></a>
</span><span id="Filters.incremental_filter-68"><a href="#Filters.incremental_filter-68"><span class="linenos">68</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-69"><a href="#Filters.incremental_filter-69"><span class="linenos">69</span></a>            <span class="k">if</span> <span class="n">increment_df</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-70"><a href="#Filters.incremental_filter-70"><span class="linenos">70</span></a>                <span class="k">if</span> <span class="n">greater_or_equal</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-71"><a href="#Filters.incremental_filter-71"><span class="linenos">71</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters.incremental_filter-72"><a href="#Filters.incremental_filter-72"><span class="linenos">72</span></a>                        <span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">increment_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">increment_col</span><span class="p">]</span>
</span><span id="Filters.incremental_filter-73"><a href="#Filters.incremental_filter-73"><span class="linenos">73</span></a>                    <span class="p">)</span>
</span><span id="Filters.incremental_filter-74"><a href="#Filters.incremental_filter-74"><span class="linenos">74</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-75"><a href="#Filters.incremental_filter-75"><span class="linenos">75</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters.incremental_filter-76"><a href="#Filters.incremental_filter-76"><span class="linenos">76</span></a>                        <span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">increment_df</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">increment_col</span><span class="p">]</span>
</span><span id="Filters.incremental_filter-77"><a href="#Filters.incremental_filter-77"><span class="linenos">77</span></a>                    <span class="p">)</span>
</span><span id="Filters.incremental_filter-78"><a href="#Filters.incremental_filter-78"><span class="linenos">78</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-79"><a href="#Filters.incremental_filter-79"><span class="linenos">79</span></a>                <span class="k">if</span> <span class="n">greater_or_equal</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-80"><a href="#Filters.incremental_filter-80"><span class="linenos">80</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">increment_value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters.incremental_filter-81"><a href="#Filters.incremental_filter-81"><span class="linenos">81</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Filters.incremental_filter-82"><a href="#Filters.incremental_filter-82"><span class="linenos">82</span></a>                    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">increment_value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters.incremental_filter-83"><a href="#Filters.incremental_filter-83"><span class="linenos">83</span></a>
</span><span id="Filters.incremental_filter-84"><a href="#Filters.incremental_filter-84"><span class="linenos">84</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


            <div class="docstring"><p>Incrementally Filter a certain dataframe given an increment logic.</p>

<p>This logic can either be an increment value or an increment dataframe from
which the get the latest value from. By default, the operator for the
filtering process is greater or equal to cover cases where we receive late
arriving data not cover in a previous load. You can change greater_or_equal
to false to use greater, when you trust the source will never output more data
with the increment after you have load the data (e.g., you will never load
data until the source is still dumping data, which may cause you to get an
incomplete picture of the last arrived data).</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_col:</strong>  input column name</li>
<li><strong>increment_value:</strong>  value to which to filter the data, considering the
provided input_Col.</li>
<li><strong>increment_df:</strong>  a dataframe to get the increment value from.
you either specify this or the increment_value (this takes precedence).
This is a good approach to get the latest value from a given dataframe
that was read and apply that value as filter here. In this way you can
perform incremental loads based on the last value of a given dataframe
(e.g., table or file based). Can be used together with the
get_max_value transformer to accomplish these incremental based loads.
See our append load feature tests  to see how to provide an acon for
incremental loads, taking advantage of the scenario explained here.</li>
<li><strong>increment_col:</strong>  name of the column from which to get the increment
value from (when using increment_df approach). This assumes there's
only one row in the increment_df, reason why is a good idea to use
together with the get_max_value transformer. Defaults to "latest"
because that's the default output column name provided by the
get_max_value transformer.</li>
<li><strong>greater_or_equal:</strong>  if filtering should be done by also including the
increment value or not (useful for scenarios where you are performing
increment loads but still want to include data considering the increment
value, and not only values greater than that increment... examples may
include scenarios where you already loaded data including those values,
but the source produced more data containing those values).
Defaults to false.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A function to be called in .transform() spark function.</p>
</blockquote>
</div>


                                <details>
    <summary>View Example</summary>
    <div class="pdoc-code codehilite"><pre><span></span><a href="#-38"><span class="linenos">38</span></a><span class="p">{</span>
<a href="#-39"><span class="linenos">39</span></a><span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;incremental_filter&quot;</span><span class="p">,</span>
<a href="#-40"><span class="linenos">40</span></a><span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a href="#-41"><span class="linenos">41</span></a><span class="w">        </span><span class="nt">&quot;input_col&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;actrequest_timestamp&quot;</span><span class="p">,</span>
<a href="#-42"><span class="linenos">42</span></a><span class="w">        </span><span class="nt">&quot;increment_df&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;max_sales_bronze_timestamp&quot;</span>
<a href="#-43"><span class="linenos">43</span></a><span class="w">    </span><span class="p">}</span>
<a href="#-44"><span class="linenos">44</span></a><span class="p">}</span>
</pre></div>

    </details>

                                <section>
        <a class="pdoc-button git-button" href="https://github.com/adidas/lakehouse-engine/blob/master/tests/resources/feature/delta_load/record_mode_cdc/backfill/batch_delta.json" target="_blank">View Full Acon</a>
    </section>
    </br>
    </br>

                    </div>
                    <div id="Filters.expression_filter" class="classattr">
                                <input id="Filters.expression_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">expression_filter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Callable</span>:</span></span>

                <label class="view-source-button" for="Filters.expression_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Filters.expression_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Filters.expression_filter-86"><a href="#Filters.expression_filter-86"><span class="linenos"> 86</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Filters.expression_filter-87"><a href="#Filters.expression_filter-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">expression_filter</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters.expression_filter-88"><a href="#Filters.expression_filter-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a dataframe based on an expression.</span>
</span><span id="Filters.expression_filter-89"><a href="#Filters.expression_filter-89"><span class="linenos"> 89</span></a>
</span><span id="Filters.expression_filter-90"><a href="#Filters.expression_filter-90"><span class="linenos"> 90</span></a><span class="sd">        Args:</span>
</span><span id="Filters.expression_filter-91"><a href="#Filters.expression_filter-91"><span class="linenos"> 91</span></a><span class="sd">            exp: filter expression.</span>
</span><span id="Filters.expression_filter-92"><a href="#Filters.expression_filter-92"><span class="linenos"> 92</span></a>
</span><span id="Filters.expression_filter-93"><a href="#Filters.expression_filter-93"><span class="linenos"> 93</span></a><span class="sd">        Returns:</span>
</span><span id="Filters.expression_filter-94"><a href="#Filters.expression_filter-94"><span class="linenos"> 94</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters.expression_filter-95"><a href="#Filters.expression_filter-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters.expression_filter-96"><a href="#Filters.expression_filter-96"><span class="linenos"> 96</span></a>
</span><span id="Filters.expression_filter-97"><a href="#Filters.expression_filter-97"><span class="linenos"> 97</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters.expression_filter-98"><a href="#Filters.expression_filter-98"><span class="linenos"> 98</span></a>            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters.expression_filter-99"><a href="#Filters.expression_filter-99"><span class="linenos"> 99</span></a>
</span><span id="Filters.expression_filter-100"><a href="#Filters.expression_filter-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


            <div class="docstring"><p>Filter a dataframe based on an expression.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>exp:</strong>  filter expression.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A function to be called in .transform() spark function.</p>
</blockquote>
</div>


                                <details>
    <summary>View Example</summary>
    <div class="pdoc-code codehilite"><pre><span></span><a href="#-20"><span class="linenos">20</span></a><span class="p">{</span>
<a href="#-21"><span class="linenos">21</span></a><span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;expression_filter&quot;</span><span class="p">,</span>
<a href="#-22"><span class="linenos">22</span></a><span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a href="#-23"><span class="linenos">23</span></a><span class="w">        </span><span class="nt">&quot;exp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date like &#39;2016%&#39;&quot;</span>
<a href="#-24"><span class="linenos">24</span></a><span class="w">    </span><span class="p">}</span>
<a href="#-25"><span class="linenos">25</span></a><span class="p">}</span>
</pre></div>

    </details>

                                <section>
        <a class="pdoc-button git-button" href="https://github.com/adidas/lakehouse-engine/blob/master/tests/resources/feature/full_load/with_filter/batch.json" target="_blank">View Full Acon</a>
    </section>
    </br>
    </br>

                    </div>
                    <div id="Filters.column_filter_exp" class="classattr">
                                <input id="Filters.column_filter_exp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">column_filter_exp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">exp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Callable</span>:</span></span>

                <label class="view-source-button" for="Filters.column_filter_exp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Filters.column_filter_exp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Filters.column_filter_exp-102"><a href="#Filters.column_filter_exp-102"><span class="linenos">102</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Filters.column_filter_exp-103"><a href="#Filters.column_filter_exp-103"><span class="linenos">103</span></a>    <span class="k">def</span> <span class="nf">column_filter_exp</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters.column_filter_exp-104"><a href="#Filters.column_filter_exp-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a dataframe&#39;s columns based on a list of SQL expressions.</span>
</span><span id="Filters.column_filter_exp-105"><a href="#Filters.column_filter_exp-105"><span class="linenos">105</span></a>
</span><span id="Filters.column_filter_exp-106"><a href="#Filters.column_filter_exp-106"><span class="linenos">106</span></a><span class="sd">        Args:</span>
</span><span id="Filters.column_filter_exp-107"><a href="#Filters.column_filter_exp-107"><span class="linenos">107</span></a><span class="sd">            exp: column filter expressions.</span>
</span><span id="Filters.column_filter_exp-108"><a href="#Filters.column_filter_exp-108"><span class="linenos">108</span></a>
</span><span id="Filters.column_filter_exp-109"><a href="#Filters.column_filter_exp-109"><span class="linenos">109</span></a><span class="sd">        Returns:</span>
</span><span id="Filters.column_filter_exp-110"><a href="#Filters.column_filter_exp-110"><span class="linenos">110</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters.column_filter_exp-111"><a href="#Filters.column_filter_exp-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters.column_filter_exp-112"><a href="#Filters.column_filter_exp-112"><span class="linenos">112</span></a>
</span><span id="Filters.column_filter_exp-113"><a href="#Filters.column_filter_exp-113"><span class="linenos">113</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters.column_filter_exp-114"><a href="#Filters.column_filter_exp-114"><span class="linenos">114</span></a>            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">selectExpr</span><span class="p">(</span><span class="o">*</span><span class="n">exp</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Filters.column_filter_exp-115"><a href="#Filters.column_filter_exp-115"><span class="linenos">115</span></a>
</span><span id="Filters.column_filter_exp-116"><a href="#Filters.column_filter_exp-116"><span class="linenos">116</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


            <div class="docstring"><p>Filter a dataframe's columns based on a list of SQL expressions.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>exp:</strong>  column filter expressions.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A function to be called in .transform() spark function.</p>
</blockquote>
</div>


                                <details>
    <summary>View Example</summary>
    <div class="pdoc-code codehilite"><pre><span></span><a href="#-21"><span class="linenos">21</span></a><span class="p">{</span>
<a href="#-22"><span class="linenos">22</span></a><span class="w">    </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;column_filter_exp&quot;</span><span class="p">,</span>
<a href="#-23"><span class="linenos">23</span></a><span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a href="#-24"><span class="linenos">24</span></a><span class="w">        </span><span class="nt">&quot;exp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a href="#-25"><span class="linenos">25</span></a><span class="w">            </span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
<a href="#-26"><span class="linenos">26</span></a><span class="w">            </span><span class="s2">&quot;country&quot;</span><span class="p">,</span>
<a href="#-27"><span class="linenos">27</span></a><span class="w">            </span><span class="s2">&quot;customer_number&quot;</span>
<a href="#-28"><span class="linenos">28</span></a><span class="w">        </span><span class="p">]</span>
<a href="#-29"><span class="linenos">29</span></a><span class="w">    </span><span class="p">}</span>
<a href="#-30"><span class="linenos">30</span></a><span class="p">}</span>
</pre></div>

    </details>

                                <section>
        <a class="pdoc-button git-button" href="https://github.com/adidas/lakehouse-engine/blob/master/tests/resources/feature/transformations/multiple_transform/batch.json" target="_blank">View Full Acon</a>
    </section>
    </br>
    </br>

                    </div>
                    <div id="Filters.drop_duplicate_rows" class="classattr">
                                <input id="Filters.drop_duplicate_rows-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">drop_duplicate_rows</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">watermarker</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Callable</span>:</span></span>

                <label class="view-source-button" for="Filters.drop_duplicate_rows-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Filters.drop_duplicate_rows"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Filters.drop_duplicate_rows-118"><a href="#Filters.drop_duplicate_rows-118"><span class="linenos">118</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Filters.drop_duplicate_rows-119"><a href="#Filters.drop_duplicate_rows-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">drop_duplicate_rows</span><span class="p">(</span>
</span><span id="Filters.drop_duplicate_rows-120"><a href="#Filters.drop_duplicate_rows-120"><span class="linenos">120</span></a>        <span class="n">cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">watermarker</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Filters.drop_duplicate_rows-121"><a href="#Filters.drop_duplicate_rows-121"><span class="linenos">121</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="Filters.drop_duplicate_rows-122"><a href="#Filters.drop_duplicate_rows-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Drop duplicate rows using spark function dropDuplicates().</span>
</span><span id="Filters.drop_duplicate_rows-123"><a href="#Filters.drop_duplicate_rows-123"><span class="linenos">123</span></a>
</span><span id="Filters.drop_duplicate_rows-124"><a href="#Filters.drop_duplicate_rows-124"><span class="linenos">124</span></a><span class="sd">        This transformer can be used with or without arguments.</span>
</span><span id="Filters.drop_duplicate_rows-125"><a href="#Filters.drop_duplicate_rows-125"><span class="linenos">125</span></a><span class="sd">        The provided argument needs to be a list of columns.</span>
</span><span id="Filters.drop_duplicate_rows-126"><a href="#Filters.drop_duplicate_rows-126"><span class="linenos">126</span></a><span class="sd">        For example: [“Name”,”VAT”] will drop duplicate records within</span>
</span><span id="Filters.drop_duplicate_rows-127"><a href="#Filters.drop_duplicate_rows-127"><span class="linenos">127</span></a><span class="sd">        &quot;Name&quot; and &quot;VAT&quot; columns.</span>
</span><span id="Filters.drop_duplicate_rows-128"><a href="#Filters.drop_duplicate_rows-128"><span class="linenos">128</span></a><span class="sd">        If the transformer is used without providing any columns list or providing</span>
</span><span id="Filters.drop_duplicate_rows-129"><a href="#Filters.drop_duplicate_rows-129"><span class="linenos">129</span></a><span class="sd">        an empty list, such as [] the result will be the same as using</span>
</span><span id="Filters.drop_duplicate_rows-130"><a href="#Filters.drop_duplicate_rows-130"><span class="linenos">130</span></a><span class="sd">        the distinct() pyspark function. If the watermark dict is present it will</span>
</span><span id="Filters.drop_duplicate_rows-131"><a href="#Filters.drop_duplicate_rows-131"><span class="linenos">131</span></a><span class="sd">        ensure that the drop operation will apply to rows within the watermark timeline</span>
</span><span id="Filters.drop_duplicate_rows-132"><a href="#Filters.drop_duplicate_rows-132"><span class="linenos">132</span></a><span class="sd">        window.</span>
</span><span id="Filters.drop_duplicate_rows-133"><a href="#Filters.drop_duplicate_rows-133"><span class="linenos">133</span></a>
</span><span id="Filters.drop_duplicate_rows-134"><a href="#Filters.drop_duplicate_rows-134"><span class="linenos">134</span></a>
</span><span id="Filters.drop_duplicate_rows-135"><a href="#Filters.drop_duplicate_rows-135"><span class="linenos">135</span></a><span class="sd">        Args:</span>
</span><span id="Filters.drop_duplicate_rows-136"><a href="#Filters.drop_duplicate_rows-136"><span class="linenos">136</span></a><span class="sd">            cols: column names.</span>
</span><span id="Filters.drop_duplicate_rows-137"><a href="#Filters.drop_duplicate_rows-137"><span class="linenos">137</span></a><span class="sd">            watermarker: properties to apply watermarker to the transformer.</span>
</span><span id="Filters.drop_duplicate_rows-138"><a href="#Filters.drop_duplicate_rows-138"><span class="linenos">138</span></a>
</span><span id="Filters.drop_duplicate_rows-139"><a href="#Filters.drop_duplicate_rows-139"><span class="linenos">139</span></a><span class="sd">        Returns:</span>
</span><span id="Filters.drop_duplicate_rows-140"><a href="#Filters.drop_duplicate_rows-140"><span class="linenos">140</span></a><span class="sd">            A function to be called in .transform() spark function.</span>
</span><span id="Filters.drop_duplicate_rows-141"><a href="#Filters.drop_duplicate_rows-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Filters.drop_duplicate_rows-142"><a href="#Filters.drop_duplicate_rows-142"><span class="linenos">142</span></a>
</span><span id="Filters.drop_duplicate_rows-143"><a href="#Filters.drop_duplicate_rows-143"><span class="linenos">143</span></a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
</span><span id="Filters.drop_duplicate_rows-144"><a href="#Filters.drop_duplicate_rows-144"><span class="linenos">144</span></a>            <span class="k">if</span> <span class="n">watermarker</span><span class="p">:</span>
</span><span id="Filters.drop_duplicate_rows-145"><a href="#Filters.drop_duplicate_rows-145"><span class="linenos">145</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">Watermarker</span><span class="o">.</span><span class="n">with_watermark</span><span class="p">(</span>
</span><span id="Filters.drop_duplicate_rows-146"><a href="#Filters.drop_duplicate_rows-146"><span class="linenos">146</span></a>                    <span class="n">watermarker</span><span class="p">[</span><span class="s2">&quot;col&quot;</span><span class="p">],</span> <span class="n">watermarker</span><span class="p">[</span><span class="s2">&quot;watermarking_time&quot;</span><span class="p">]</span>
</span><span id="Filters.drop_duplicate_rows-147"><a href="#Filters.drop_duplicate_rows-147"><span class="linenos">147</span></a>                <span class="p">)(</span><span class="n">df</span><span class="p">)</span>
</span><span id="Filters.drop_duplicate_rows-148"><a href="#Filters.drop_duplicate_rows-148"><span class="linenos">148</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="Filters.drop_duplicate_rows-149"><a href="#Filters.drop_duplicate_rows-149"><span class="linenos">149</span></a>                <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">()</span>
</span><span id="Filters.drop_duplicate_rows-150"><a href="#Filters.drop_duplicate_rows-150"><span class="linenos">150</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Filters.drop_duplicate_rows-151"><a href="#Filters.drop_duplicate_rows-151"><span class="linenos">151</span></a>                <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropDuplicates</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span id="Filters.drop_duplicate_rows-152"><a href="#Filters.drop_duplicate_rows-152"><span class="linenos">152</span></a>
</span><span id="Filters.drop_duplicate_rows-153"><a href="#Filters.drop_duplicate_rows-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">inner</span>
</span></pre></div>


            <div class="docstring"><p>Drop duplicate rows using spark function dropDuplicates().</p>

<p>This transformer can be used with or without arguments.
The provided argument needs to be a list of columns.
For example: [“Name”,”VAT”] will drop duplicate records within
"Name" and "VAT" columns.
If the transformer is used without providing any columns list or providing
an empty list, such as [] the result will be the same as using
the distinct() pyspark function. If the watermark dict is present it will
ensure that the drop operation will apply to rows within the watermark timeline
window.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>cols:</strong>  column names.</li>
<li><strong>watermarker:</strong>  properties to apply watermarker to the transformer.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A function to be called in .transform() spark function.</p>
</blockquote>
</div>


                    </div>
        </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>