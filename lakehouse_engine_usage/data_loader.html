<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>lakehouse_engine_usage.data_loader</title>
            <link rel="icon" href="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#000000;background-color:#f1efef;border-color:#f1f1f1;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:150%;overflow:auto;margin-bottom:1rem;}.pdoc table th, .pdoc table td{padding:12px 13px;border:1px solid var(--accent2);}.pdoc table th{font-weight:600;}</style>
    <style>/*! custom.css */</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../lakehouse_engine_usage.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lakehouse_engine_usage</a>

            <img src="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#data-loader">Data Loader</a>
  <ul>
    <li><a href="#how-to-configure-a-dataloader-algorithm-in-the-lakehouse-engine-by-using-an-acon-file">How to configure a DataLoader algorithm in the lakehouse-engine by using an ACON file?</a></li>
    <li><a href="#overview-of-the-structure-of-the-acon-file-for-dataloads">Overview of the Structure of the ACON file for DataLoads</a></li>
    <li><a href="#input-specifications">Input Specifications</a></li>
    <li><a href="#transform-specifications">Transform Specifications</a></li>
    <li><a href="#data-quality-specifications">Data Quality Specifications</a></li>
    <li><a href="#output-specifications">Output Specifications</a></li>
    <li><a href="#terminate-specifications">Terminate Specifications</a></li>
    <li><a href="#execution-environment">Execution Environment</a></li>
  </ul></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="./data_loader/append_load_from_jdbc_with_permissive_mode.html">Append Load From Jdbc With Permissive Mode</a></li>
                    <li><a href="./data_loader/append_load_with_failfast.html">Append Load With Failfast</a></li>
                    <li><a href="./data_loader/batch_delta_load_init_delta_backfill_with_merge.html">Batch Delta Load Init Delta Backfill With Merge</a></li>
                    <li><a href="./data_loader/custom_transformer.html">Custom Transformer</a></li>
                    <li><a href="./data_loader/extract_from_sap_b4_adso.html">Extract From Sap B4 Adso</a></li>
                    <li><a href="./data_loader/extract_from_sap_bw_dso.html">Extract From Sap Bw Dso</a></li>
                    <li><a href="./data_loader/extract_from_sftp.html">Extract From Sftp</a></li>
                    <li><a href="./data_loader/extract_using_jdbc_connection.html">Extract Using Jdbc Connection</a></li>
                    <li><a href="./data_loader/filtered_full_load.html">Filtered Full Load</a></li>
                    <li><a href="./data_loader/filtered_full_load_with_selective_replace.html">Filtered Full Load With Selective Replace</a></li>
                    <li><a href="./data_loader/flatten_schema_and_explode_columns.html">Flatten Schema And Explode Columns</a></li>
                    <li><a href="./data_loader/full_load.html">Full Load</a></li>
                    <li><a href="./data_loader/read_from_dataframe.html">Read From Dataframe</a></li>
                    <li><a href="./data_loader/streaming_append_load_with_malformed.html">Streaming Append Load With Malformed</a></li>
                    <li><a href="./data_loader/streaming_append_load_with_terminator.html">Streaming Append Load With Terminator</a></li>
                    <li><a href="./data_loader/streaming_delta_load_with_group_and_rank_condensation.html">Streaming Delta Load With Group And Rank Condensation</a></li>
                    <li><a href="./data_loader/streaming_delta_with_late_arriving_and_out_of_order_events.html">Streaming Delta With Late Arriving And Out Of Order Events</a></li>
                    <li><a href="./data_loader/write_and_read_dataframe.html">Write And Read Dataframe</a></li>
                    <li><a href="./data_loader/write_to_console.html">Write To Console</a></li>
            </ul>


            <footer>Lakehouse Engine v1.20.0</footer>

</div>
    </nav>
    <main class="pdoc">
    <section class="module-info">

                <div class="docstring"><h1 id="data-loader">Data Loader</h1>

<h2 id="how-to-configure-a-dataloader-algorithm-in-the-lakehouse-engine-by-using-an-acon-file">How to configure a DataLoader algorithm in the lakehouse-engine by using an ACON file?</h2>

<p>An algorithm (e.g., data load) in the lakehouse-engine is configured using an ACON. The lakehouse-engine is a
configuration-driven framework, so people don't have to write code to execute a Spark algorithm. In contrast, the
algorithm is written in pyspark and accepts configurations through a JSON file (an ACON - algorithm configuration). The
ACON is the configuration providing the behaviour of a lakehouse engine algorithm. <a href="../lakehouse_engine/algorithms/algorithm.html">You can check the algorithm code, and
how it interprets the ACON here</a>.
In this page we will go through the structure of an ACON file and what are the most suitable ACON files for common data
engineering scenarios.
Check the underneath pages to find several <strong>ACON examples</strong> that cover many data extraction, transformation and loading scenarios.</p>

<h2 id="overview-of-the-structure-of-the-acon-file-for-dataloads">Overview of the Structure of the ACON file for DataLoads</h2>

<p>An ACON-based algorithm needs several specifications to work properly, but some of them might be optional. The available
specifications are:</p>

<ul>
<li><strong>Input specifications (input_specs)</strong>: specify how to read data. This is a <strong>mandatory</strong> keyword.</li>
<li><strong>Transform specifications (transform_specs)</strong>: specify how to transform data.</li>
<li><strong>Data quality specifications (dq_specs)</strong>: specify how to execute the data quality process.</li>
<li><strong>Output specifications (output_specs)</strong>: specify how to write data to the target. This is a <strong>mandatory</strong> keyword.</li>
<li><strong>Terminate specifications (terminate_specs)</strong>: specify what to do after writing into the target (e.g., optimising target table, vacuum, compute stats, expose change data feed to external location, etc.).</li>
<li><strong>Execution environment (exec_env)</strong>: custom Spark session configurations to be provided for your algorithm (configurations can also be provided from your job/cluster configuration, which we highly advise you to do instead of passing performance related configs here for example).</li>
</ul>

<p>Below is an example of a complete ACON file that reads from a s3 folder with CSVs and incrementally loads that data (using a merge) into a delta lake table.</p>

<div class="pdoc-alert pdoc-alert-note">

<p><strong>spec_id</strong> is one of the main concepts to ensure you can chain the steps of the algorithm, so, for example, you can specify the transformations (in transform_specs) of a DataFrame that was read in the input_specs. Check ACON below to see how the spec_id of the input_specs is used as input_id in one transform specification.</p>

</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;orders_bronze&quot;</span><span class="p">,</span>
      <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;streaming&quot;</span><span class="p">,</span>
      <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
      <span class="s2">&quot;schema_path&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my-data-product-bucket/artefacts/metadata/bronze/schemas/orders.json&quot;</span><span class="p">,</span>
      <span class="s2">&quot;with_filepath&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;badRecordsPath&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my-data-product-bucket/badrecords/order_events_with_dq/&quot;</span><span class="p">,</span>
        <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\u005E</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dateFormat&quot;</span><span class="p">:</span> <span class="s2">&quot;yyyyMMdd&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my-data-product-bucket/bronze/orders/&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;transform_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;orders_bronze_with_extraction_date&quot;</span><span class="p">,</span>
      <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;orders_bronze&quot;</span><span class="p">,</span>
      <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;with_row_id&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;with_regex_value&quot;</span><span class="p">,</span>
          <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;lhe_extraction_filepath&quot;</span><span class="p">,</span>
            <span class="s2">&quot;output_col&quot;</span><span class="p">:</span> <span class="s2">&quot;extraction_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;drop_input_col&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;regex&quot;</span><span class="p">:</span> <span class="s2">&quot;.*WE_SO_SCL_(</span><span class="se">\\</span><span class="s2">d+).csv&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;dq_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;check_orders_bronze_with_extraction_date&quot;</span><span class="p">,</span>
      <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;orders_bronze_with_extraction_date&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dq_type&quot;</span><span class="p">:</span> <span class="s2">&quot;validator&quot;</span><span class="p">,</span>
      <span class="s2">&quot;result_sink_db_table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table_dq_checks&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fail_on_error&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s2">&quot;dq_functions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;dq_function&quot;</span><span class="p">:</span> <span class="s2">&quot;expect_column_values_to_not_be_null&quot;</span><span class="p">,</span>
          <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;omnihub_locale_code&quot;</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;dq_function&quot;</span><span class="p">:</span> <span class="s2">&quot;expect_column_unique_value_count_to_be_between&quot;</span><span class="p">,</span>
          <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;product_division&quot;</span><span class="p">,</span>
            <span class="s2">&quot;min_value&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;max_value&quot;</span><span class="p">:</span> <span class="mi">100</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;dq_function&quot;</span><span class="p">:</span> <span class="s2">&quot;expect_column_max_to_be_between&quot;</span><span class="p">,</span>
          <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;so_net_value&quot;</span><span class="p">,</span>
            <span class="s2">&quot;min_value&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;max_value&quot;</span><span class="p">:</span> <span class="mi">1000</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;dq_function&quot;</span><span class="p">:</span> <span class="s2">&quot;expect_column_value_lengths_to_be_between&quot;</span><span class="p">,</span>
          <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;omnihub_locale_code&quot;</span><span class="p">,</span>
            <span class="s2">&quot;min_value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;max_value&quot;</span><span class="p">:</span> <span class="mi">10</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;dq_function&quot;</span><span class="p">:</span> <span class="s2">&quot;expect_column_mean_to_be_between&quot;</span><span class="p">,</span>
          <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;coupon_code&quot;</span><span class="p">,</span>
            <span class="s2">&quot;min_value&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
            <span class="s2">&quot;max_value&quot;</span><span class="p">:</span> <span class="mi">20</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;orders_silver&quot;</span><span class="p">,</span>
      <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;check_orders_bronze_with_extraction_date&quot;</span><span class="p">,</span>
      <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
      <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;merge&quot;</span><span class="p">,</span>
      <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;order_date_header&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;merge_opts&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;merge_predicate&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            new.sales_order_header = current.sales_order_header</span>
<span class="s2">            and new.sales_order_schedule = current.sales_order_schedule</span>
<span class="s2">            and new.sales_order_item=current.sales_order_item</span>
<span class="s2">            and new.epoch_status=current.epoch_status</span>
<span class="s2">            and new.changed_on=current.changed_on</span>
<span class="s2">            and new.extraction_date=current.extraction_date</span>
<span class="s2">            and new.lhe_batch_id=current.lhe_batch_id</span>
<span class="s2">            and new.lhe_row_id=current.lhe_row_id</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert_only&quot;</span><span class="p">:</span> <span class="kc">True</span>
      <span class="p">},</span>
      <span class="s2">&quot;db_table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table_with_dq&quot;</span><span class="p">,</span>
      <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my-data-product-bucket/silver/order_events_with_dq/&quot;</span><span class="p">,</span>
      <span class="s2">&quot;with_batch_id&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;checkpointLocation&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my-data-product-bucket/checkpoints/order_events_with_dq/&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;terminate_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;optimize_dataset&quot;</span><span class="p">,</span>
      <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;db_table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table_with_dq&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="input-specifications">Input Specifications</h2>

<p>You specify how to read the data by providing a list of Input Specifications. Usually there's just one element in that
list, as, in the lakehouse, you are generally focused on reading data from one layer (e.g., source, bronze, silver,
gold) and put it on the next layer. However, there may be scenarios where you would like to combine two datasets (e.g.,
joins or incremental filtering on one dataset based on the values of another
one), therefore you can use one or more elements.
<a href="../lakehouse_engine/core/definitions.html#InputSpec">More information about InputSpecs</a>.</p>

<h5 id="relevant-notes">Relevant notes</h5>

<ul>
<li>A spec id is fundamental, so you can use the input data later on in any step of the algorithm (transform, write, dq process, terminate).</li>
<li>You don't have to specify <code>db_table</code> and <code>location</code> at the same time. Depending on the data_format sometimes you read from a table (e.g., jdbc or deltalake table) sometimes you read from a location (e.g., files like deltalake, parquet, json, avro... or kafka topic).</li>
</ul>

<h2 id="transform-specifications">Transform Specifications</h2>

<p>In the lakehouse engine, you transform data by providing a transform specification, which contains a list of transform functions (transformers). So the transform specification acts upon on input, and it can execute multiple lakehouse engine transformation functions (transformers) upon that input.</p>

<p>If you look into the example above we ask the lakehouse engine to execute two functions on the <code>orders_bronze</code> input
data: <code>with_row_id</code> and <code>with_regex_value</code>. Those functions can of course receive arguments. You can see a list of all
available transformation functions (transformers) here <code><a href="../lakehouse_engine/transformers.html">lakehouse_engine.transformers</a></code>. Then, you just invoke them in
your ACON as demonstrated above, following exactly the same function name and parameters name as described in the code
documentation. 
<a href="../lakehouse_engine/core/definitions.html#TransformSpec">More information about TransformSpec</a>.</p>

<h5 id="relevant-notes-2">Relevant notes</h5>

<ul>
<li>This stage is fully optional, you can omit it from the ACON.</li>
<li>There is one relevant option <code>force_streaming_foreach_batch_processing</code> that can be used to force the transform to be
executed in the foreachBatch function to ensure non-supported streaming operations can be properly executed. You don't
have to worry about this if you are using regular lakehouse engine transformers. But if you are providing your custom
logic in pyspark code via our lakehouse engine
custom_transformation (<code><a href="../lakehouse_engine/transformers/custom_transformers.html">lakehouse_engine.transformers.custom_transformers</a></code>) then sometimes your logic may contain
Spark functions that are not compatible with Spark Streaming, and therefore this flag can enable all of your
computation to be streaming-compatible by pushing down all the logic into the foreachBatch() function.</li>
</ul>

<h2 id="data-quality-specifications">Data Quality Specifications</h2>

<p>One of the most relevant features of the lakehouse engine is that you can have data quality guardrails that prevent you
from loading bad data into your target layer (e.g., bronze, silver or gold). The lakehouse engine data quality process
includes two main features at the moment:</p>

<ul>
<li><strong>Assistant</strong>: The capability to profile data out of a read (<code>input_spec</code>) or transform (<code>transform_spec</code>) stage and based
on the profiling, display it and generate expectations that can be used for the validator.</li>
<li><strong>Validator</strong>: The capability to perform data quality checks on that data (e.g., is the max value of a column bigger
than x?) and even tag your data with the results of the DQ checks.</li>
</ul>

<p>The output of the data quality process can be written into a <a href="data_quality/result_sink.html"><strong>Result Sink</strong></a> target (e.g. table or files) and is integrated with a <a href="data_quality.html#3-data-docs-website">Data Docs website</a>, which can be a company-wide available website for people to check the quality of their data and share with others.</p>

<p>To achieve all of this functionality the lakehouse engine uses <a href="https://greatexpectations.io/">Great Expectations</a> internally. To hide the Great Expectations internals from our user base and provide friendlier abstractions using the ACON, we have developed the concept of DQSpec that can contain many DQFunctionSpec objects, which is very similar to the relationship between the TransformSpec and TransformerSpec, which means you can have multiple Great Expectations functions executed inside a single data quality specification (as in the ACON above).</p>

<div class="pdoc-alert pdoc-alert-note">

<p>The names of the functions and args are a 1 to 1 match of <a href="https://greatexpectations.io/expectations/">Great Expectations API</a>.</p>

</div>

<p><a href="../lakehouse_engine/core/definitions.html#DQSpec">More information about DQSpec</a>.</p>

<h5 id="relevant-notes-3">Relevant notes</h5>

<ul>
<li>You can write the outputs of the DQ process to a sink through the result_sink* parameters of the
DQSpec. <code>result_sink_options</code> takes any Spark options for a DataFrame writer, which means you can specify the options
according to your sink format (e.g., delta, parquet, json, etc.). We usually recommend using <code>"delta"</code> as format.</li>
<li>You can use the results of the DQ checks to tag the data that you are validating. When configured, these details will
appear as a new column (like any other), as part of the tables of your Data Product.</li>
<li>To be able to make an analysis with the data of <code>result_sink*</code>, we have available an approach in which you
set <code>result_sink_explode</code> as true (which is the default) and then you have some columns expanded. Those are:
<ul>
<li>General columns: Those are columns that have the basic information regarding <code>dq_specs</code> and will have always values
and does not depend on the expectation types chosen.
  -
Columns: <code>checkpoint_config</code>, <code>run_name</code>, <code>run_time</code>, <code>run_results</code>, <code>success</code>, <code>validation_result_identifier</code>, <code>spec_id</code>, <code>input_id</code>, <code>validation_results</code>, <code>run_time_year</code>, <code>run_time_month</code>, <code>run_time_day</code>.</li>
<li>Statistics columns: Those are columns that have information about the runs of expectations, being those values for
the run and not for each expectation. Those columns come from <code>run_results.validation_result.statistics.*</code>.
<ul>
<li>Columns: <code>evaluated_expectations</code>, <code>success_percent</code>, <code>successful_expectations</code>, <code>unsuccessful_expectations</code>.</li>
</ul></li>
<li>Expectations columns: Those are columns that have information about the expectation executed.
<ul>
<li>Columns: <code>expectation_type</code>, <code>batch_id</code>, <code>expectation_success</code>, <code>exception_info</code>. Those columns are exploded
from <code>run_results.validation_result.results</code>
inside <code>expectation_config.expectation_type</code>, <code>expectation_config.kwargs.batch_id</code>, <code>success as expectation_success</code>,
and <code>exception_info</code>. Moreover, we also include <code>unexpected_index_list</code>, <code>observed_value</code> and <code>kwargs</code>.</li>
</ul></li>
<li>Arguments of Expectations columns: Those are columns that will depend on the expectation_type selected. Those
columns are exploded from <code>run_results.validation_result.results</code> inside <code>expectation_config.kwargs.*</code>.
<ul>
<li>We can have for
example: <code>column</code>, <code>column_A</code>, <code>column_B</code>, <code>max_value</code>, <code>min_value</code>, <code>value</code>, <code>value_pairs_set</code>, <code>value_set</code>,
and others.</li>
</ul></li>
<li>More columns desired? Those can be added, using <code>result_sink_extra_columns</code> in which you can select columns
like <code>&lt;name&gt;</code> and/or explode columns like <code>&lt;name&gt;.*</code>.</li>
</ul></li>
<li>Use the parameter <code>"source"</code> to identify the data used for an easier analysis.</li>
<li>By default, Great Expectation will also provide a site presenting the history of the DQ validations that you have performed on your data.</li>
<li>You can make an analysis of all your expectations and create a dashboard aggregating all that information.</li>
<li>This stage is fully optional, you can omit it from the ACON.</li>
</ul>

<h2 id="output-specifications">Output Specifications</h2>

<p>The output_specs section of an ACON is relatively similar to the input_specs section, but of course focusing on how to write the results of the algorithm, instead of specifying the input for the algorithm, hence the name output_specs (output specifications). <a href="../lakehouse_engine/core/definitions.html#OutputSpec">More information about OutputSpec</a>.</p>

<h5 id="relevant-notes-4">Relevant notes</h5>

<ul>
<li>Respect the supported write types and output formats.</li>
<li>One of the most relevant options to specify in the options parameter is the <code>checkpoint_location</code> when in streaming
read mode, because that location will be responsible for storing which data you already read and transformed from the
source, <strong>when the source is a Spark Streaming compatible source (e.g., Kafka or S3 files)</strong>.</li>
</ul>

<h2 id="terminate-specifications">Terminate Specifications</h2>

<p>The terminate_specs section of the ACON is responsible for some "wrapping up" activities like optimising a table,
vacuuming old files in a delta table, etc. With time the list of available terminators will likely increase (e.g.,
reconciliation processes), but for now we have the <a href="../lakehouse_engine/terminators.html">following terminators</a>.
This stage is fully optional, you can omit it from the ACON.
The most relevant now in the context of the lakehouse initiative are the following:</p>

<ul>
<li><a href="../lakehouse_engine/terminators/dataset_optimizer.html">dataset_optimizer</a></li>
<li><a href="../lakehouse_engine/terminators/cdf_processor.html">cdf_processor</a></li>
<li><a href="../lakehouse_engine/terminators/sensor_terminator.html">sensor_terminator</a></li>
<li><a href="../lakehouse_engine/terminators/notifiers/email_notifier.html">notifier_terminator</a></li>
</ul>

<p><a href="../lakehouse_engine/core/definitions.html#TerminatorSpec">More information about TerminatorSpec</a>.</p>

<h2 id="execution-environment">Execution Environment</h2>

<p>In the exec_env section of the ACON you can pass any Spark Session configuration that you want to define for the
execution of your algorithm. This is basically just a JSON structure that takes in any Spark Session property, so no
custom lakehouse engine logic. This stage is fully optional, you can omit it from the ACON.</p>

<div class="pdoc-alert pdoc-alert-note">

<p>Please be aware that Spark Session configurations that are not allowed to be changed when the Spark cluster is already
running need to be passed in the configuration of the job/cluster that runs this algorithm, not here in this section.
This section only accepts Spark Session configs that can be changed in runtime. Whenever you introduce an option make
sure that it takes effect during runtime, as to the best of our knowledge there's no list of allowed Spark properties
to be changed after the cluster is already running. Moreover, typically Spark algorithms fail if you try to modify a
config that can only be set up before the cluster is running.</p>

</div>
</div>

    </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>