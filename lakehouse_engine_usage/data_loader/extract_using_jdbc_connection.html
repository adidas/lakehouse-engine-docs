<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.5.1"/>
    <title>lakehouse_engine_usage.data_loader.extract_using_jdbc_connection</title>
            <link rel="icon" href="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#000000;background-color:#f1efef;border-color:#f1f1f1;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:150%;overflow:auto;margin-bottom:1rem;}.pdoc table th, .pdoc table td{padding:12px 13px;border:1px solid var(--accent2);}.pdoc table th{font-weight:600;}</style>
    <style>/*! custom.css */</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../data_loader.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lakehouse_engine_usage.data_loader</a>

            <img src="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#extract-using-jdbc-connection">Extract using JDBC connection</a>
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-simplest-scenario-using-sqlite">The Simplest Scenario using sqlite</a></li>
    <li><a href="#template-with-more-complete-and-runnable-examples">Template with more complete and runnable examples</a></li>
  </ul></li>
</ul>




            <footer>Lakehouse Engine v1.23.0</footer>

</div>
    </nav>
    <main class="pdoc">
    <section class="module-info">

                <div class="docstring"><h1 id="extract-using-jdbc-connection">Extract using JDBC connection</h1>

<div class="pdoc-alert pdoc-alert-danger">

<h6 id="sap-extraction"><strong>SAP Extraction</strong></h6>

<p>SAP is only used as an example to demonstrate how we can use a JDBC connection to extract data.</p>

<p><strong>If you are looking to extract data from SAP, please use our sap_b4 or sap_bw reader.</strong></p>

<p>You can find the <strong>sap_b4 reader</strong> documentation: <a href="../../lakehouse_engine_usage/data_loader/extract_from_sap_b4_adso.html">Extract from SAP B4 ADSOs</a> and the <strong>sap_bw reader</strong> documentarion: <a href="../../lakehouse_engine_usage/data_loader/extract_from_sap_bw_dso.html">Extract from SAP BW DSOs</a></p>

</div>

<div class="pdoc-alert pdoc-alert-danger">

<h6 id="parallel-extraction"><strong>Parallel Extraction</strong></h6>

<p>Parallel extractions <strong>can bring a jdbc source down</strong> if a lot of stress is put on the system. Be careful choosing the number of partitions. Spark is a distributed system and can lead to many connections.</p>

</div>

<h2 id="introduction">Introduction</h2>

<p>Many databases allow a JDBC connection to extract data. Our engine has one reader where you can configure all the necessary definitions to connect to a database using JDBC.</p>

<p>In the next section you will find several examples about how to do it.</p>

<h2 id="the-simplest-scenario-using-sqlite">The Simplest Scenario using sqlite</h2>

<div class="pdoc-alert pdoc-alert-warning">

<h6 id="not-parallel-recommended-for-smaller-datasets-only-or-when-stressing-the-source-system-is-a-high-concern">Not parallel -  Recommended for smaller datasets only, or when stressing the source system is a high concern</h6>

</div>

<p>This scenario is the simplest one we can have, not taking any advantage of Spark JDBC optimisation techniques and using a single connection to retrieve all the data from the source.</p>

<p>Here we use a sqlite database where any connection is allowed. Due to that, we do not specify any username or password.</p>

<p>Same as spark, we provide two different ways to run jdbc reader.</p>

<p>1 - We can use the <strong>jdbc() function</strong>, passing inside all the arguments needed for Spark to work, and we can even combine this with additional options passed through .options().</p>

<p>2 - Other way is using <strong>.format("jdbc")</strong> and pass all necessary arguments through .options(). It's important to say by choosing jdbc() we can also add options() to the execution.</p>

<p><strong>You can find and run the following code in our local test for the engine.</strong></p>

<h3 id="jdbc-function">jdbc() function</h3>

<p>As we can see in the next cell, all the arguments necessary to establish the jdbc connection are passed inside the <code>jdbc_args</code> object. Here we find the url, the table, and the driver. Besides that, we can add options, such as the partition number. The partition number will impact in the queries' parallelism.</p>

<p>The below code is an example in how to use jdbc() function in our ACON.
As for other cases, the acon configuration should be executed with <code>load_data</code> using:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<p>Example of ACON configuration:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;input_specs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;spec_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales_source&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;read_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;data_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;jdbc_args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdbc:sqlite:/app/tests/lakehouse/in/feature/jdbc_reader/jdbc_function/correct_arguments/tests.db&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdbc_function&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;driver&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;org.sqlite.JDBC&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;numPartitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;output_specs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;spec_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales_bronze&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;input_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales_source&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;write_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;db_table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test_db.jdbc_function_table&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;data_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;partitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;date&quot;</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file:///app/tests/lakehouse/out/feature/jdbc_reader/jdbc_function/correct_arguments/data&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This is same as using the following code in pyspark:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">jdbc</span><span class="p">(</span>
  <span class="n">url</span><span class="o">=</span><span class="s2">&quot;jdbc:sqlite:/app/tests/lakehouse/in/feature/jdbc_reader/jdbc_function/correct_arguments/tests.db&quot;</span><span class="p">,</span>
  <span class="n">table</span><span class="o">=</span><span class="s2">&quot;jdbc_function&quot;</span><span class="p">,</span>
  <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;driver&quot;</span><span class="p">:</span><span class="s2">&quot;org.sqlite.JDBC&quot;</span><span class="p">})</span>
  <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;numPartitions&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="formatjdbc">.format("jdbc")</h3>

<p>In this example we do not use the <code>jdbc_args</code> object. All the jdbc connection parameters are inside the dictionary with the object options.
As for other cases, the acon configuration should be executed with <code>load_data</code> using:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<p>Example of ACON configuration:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;input_specs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;spec_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales_source&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;read_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;data_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdbc:sqlite:/app/tests/lakehouse/in/feature/jdbc_reader/jdbc_format/correct_arguments/tests.db&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dbtable&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdbc_format&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;driver&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;org.sqlite.JDBC&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;numPartitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;output_specs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;spec_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales_bronze&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;input_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales_source&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;write_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;db_table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test_db.jdbc_format_table&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;data_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;partitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;date&quot;</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file:///app/tests/lakehouse/out/feature/jdbc_reader/jdbc_format/correct_arguments/data&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This is same as using the following code in pyspark:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;jdbc&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;jdbc:sqlite:/app/tests/lakehouse/in/feature/jdbc_reader/jdbc_format/correct_arguments/tests.db&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;driver&quot;</span><span class="p">,</span> <span class="s2">&quot;org.sqlite.JDBC&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;dbtable&quot;</span><span class="p">,</span> <span class="s2">&quot;jdbc_format&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;numPartitions&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="template-with-more-complete-and-runnable-examples">Template with more complete and runnable examples</h2>

<p>In this template we will use a <strong>SAP as example</strong> for a more complete and runnable example.
These definitions can be used in several databases that allow JDBC connection.</p>

<p>The following scenarios of extractions are covered:</p>

<ul>
<li>1 - The Simplest Scenario (Not parallel -  Recommended for smaller datasets only,
or when stressing the source system is a high concern)</li>
<li>2 - Parallel extraction 
<ul>
<li>2.1 - Simplest Scenario </li>
<li>2.2 - Provide upperBound (Recommended)</li>
<li>2.3 - Provide predicates (Recommended)</li>
</ul></li>
</ul>

<div class="pdoc-alert pdoc-alert-note">

<p>Disclaimer: This template only uses <strong>SAP as demonstration example for JDBC connection.</strong>
<strong>This isn't a SAP template!!!</strong>
<strong>If you are looking to extract data from SAP, please use our sap_b4 reader or the sap_bw reader.</strong></p>

</div>

<p>The JDBC connection has 2 main sections to be filled, the <strong>jdbc_args</strong> and <strong>options</strong>:</p>

<ul>
<li>jdbc_args - Here you need to fill everything related to jdbc connection itself, like table/query, url, user,
..., password.</li>
<li>options - This section is more flexible, and you can provide additional options like "fetchSize", "batchSize",
"numPartitions", ..., upper and "lowerBound".</li>
</ul>

<p>If you want to know more regarding jdbc spark options you can follow the link below:</p>

<ul>
<li><a href="https://spark.apache.org/docs/latest/sql-data-sources-jdbc.html">https://spark.apache.org/docs/latest/sql-data-sources-jdbc.html</a></li>
</ul>

<p>If you want to have a better understanding about JDBC Spark optimizations, you can find them in the following:</p>

<ul>
<li><a href="https://docs.databricks.com/en/connect/external-systems/jdbc.html">https://docs.databricks.com/en/connect/external-systems/jdbc.html</a></li>
<li><a href="https://stackoverflow.com/questions/41085238/what-is-the-meaning-of-partitioncolumn-lowerbound-upperbound-numpartitions-pa">https://stackoverflow.com/questions/41085238/what-is-the-meaning-of-partitioncolumn-lowerbound-upperbound-numpartitions-pa</a></li>
<li><a href="https://newbedev.com/how-to-optimize-partitioning-when-migrating-data-from-jdbc-source">https://newbedev.com/how-to-optimize-partitioning-when-migrating-data-from-jdbc-source</a></li>
</ul>

<h3 id="1-the-simplest-scenario-not-parallel-recommended-for-smaller-datasets-or-for-not-stressing-the-source">1 - The Simplest Scenario (Not parallel - Recommended for smaller datasets, or for not stressing the source)</h3>

<p>This scenario is the simplest one we can have, not taking any advantage of Spark JDBC optimisation techniques
and using a single connection to retrieve all the data from the source. It should only be used in case the data
you want to extract from is a small one, with no big requirements in terms of performance to fulfill.
When extracting from the source, we can have two options:</p>

<ul>
<li><strong>Delta Init</strong> - full extraction of the source. You should use it in the first time you extract from the
source or any time you want to re-extract completely. Similar to a so-called full load.</li>
<li><strong>Delta</strong> - extracts the portion of the data that is new or has changed in the source, since the last
extraction (for that, the logic at the transformation step needs to be applied). On the examples below,
the logic using REQTSN column is applied, which means that the maximum value on bronze is filtered
and its value is used to filter incoming data from the data source.</li>
</ul>

<h5 id="init-load-data-into-the-bronze-bucket">Init - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;REQTSN&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/no_parallel/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h5 id="delta-load-data-into-the-bronze-bucket">Delta - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_jdbc_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/no_parallel/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;transform_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;get_max_value&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;REQTSN&quot;</span><span class="p">}}],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;incremental_filter&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;REQTSN&quot;</span><span class="p">,</span> <span class="s2">&quot;increment_df&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">},</span>
                <span class="p">}</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;append&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;REQTSN&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/no_parallel/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="2-parallel-extraction">2 - Parallel extraction</h3>

<p>On this section we present 3 possible scenarios for parallel extractions from JDBC sources.</p>

<div class="pdoc-alert pdoc-alert-note">

<p>Disclaimer for parallel extraction: Parallel extractions can bring a jdbc source down if a lot of stress
is put on the system. <strong>Be careful when choosing the number of partitions. 
Spark is a distributed system and can lead to many connections.</strong></p>

</div>

<h4 id="21-parallel-extraction-simplest-scenario">2.1 - Parallel Extraction, Simplest Scenario</h4>

<p>This scenario provides the simplest example you can have for a parallel extraction from JDBC sources, only using
the property <code>numPartitions</code>. The goal of the scenario is to cover the case in which people do not have
much experience around how to optimize the extraction from JDBC sources or cannot identify a column that can
be used to split the extraction in several tasks. This scenario can also be used if the use case does not
have big performance requirements/concerns, meaning you do not feel the need to optimize the performance of
the extraction to its maximum potential.</p>

<p>On the example bellow, <code>"numPartitions": 10</code> is specified, meaning that Spark will open 10 parallel connections
to the source and automatically decide how to parallelize the extraction upon that requirement. This is the
only change compared to the example provided in the scenario 1.</p>

<h5 id="delta-init-load-data-into-the-bronze-bucket">Delta Init - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;numPartitions&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;REQTSN&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_1/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h5 id="delta-load-data-into-the-bronze-bucket-2">Delta - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;numPartitions&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_1/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;transform_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;get_max_value&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;REQTSN&quot;</span><span class="p">}}],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;incremental_filter&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;REQTSN&quot;</span><span class="p">,</span> <span class="s2">&quot;increment_df&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">},</span>
                <span class="p">}</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;append&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;REQTSN&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_1/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h4 id="22-parallel-extraction-provide-upper_bound-recommended">2.2 - Parallel Extraction, Provide upper_bound (Recommended)</h4>

<p>This scenario performs the extraction from the JDBC source in parallel, but has more concerns trying to
optimize and have more control (compared to 2.1 example) on how the extraction is split and performed,
using the following options:</p>

<ul>
<li><code>numPartitions</code> - number of Spark partitions to split the extraction.</li>
<li><code>partitionColumn</code> - column used to split the extraction. It must be a numeric, date, or timestamp.
It should be a column that is able to split the extraction evenly in several tasks. An auto-increment
column is usually a very good candidate.</li>
<li><code>lowerBound</code> - lower bound to decide the partition stride.</li>
<li><code>upperBound</code> - upper bound to decide the partition stride.</li>
</ul>

<p>This is an adequate example to be followed if there is a column in the data source that is good to
be used as the <code>partitionColumn</code>. Comparing with the previous example,
the <code>numPartitions</code> and three additional options to fine tune the extraction (<code>partitionColumn</code>, <code>lowerBound</code>,
<code>upperBound</code>) are provided.</p>

<p>When these 4 properties are used, Spark will use them to build several queries to split the extraction.
<strong>Example:</strong> for <code>"numPartitions": 10</code>, <code>"partitionColumn": "record"</code>, <code>"lowerBound: 1"</code>, <code>"upperBound: 100"</code>,
Spark will generate 10 queries like:</p>

<ul>
<li><code>SELECT * FROM dummy_table WHERE RECORD &lt; 10 OR RECORD IS NULL</code></li>
<li><code>SELECT * FROM dummy_table WHERE RECORD &gt;= 10 AND RECORD &lt; 20</code></li>
<li><code>SELECT * FROM dummy_table WHERE RECORD &gt;= 20 AND RECORD &lt; 30</code></li>
<li>...</li>
<li><code>SELECT * FROM dummy_table WHERE RECORD &gt;= 100</code></li>
</ul>

<h5 id="init-load-data-into-the-bronze-bucket-2">Init - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;partitionColumn&quot;</span><span class="p">:</span> <span class="s2">&quot;RECORD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;numPartitions&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;lowerBound&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;upperBound&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RECORD&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_2/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h5 id="delta-load-data-into-the-bronze-bucket-3">Delta - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;partitionColumn&quot;</span><span class="p">:</span> <span class="s2">&quot;RECORD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;numPartitions&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;lowerBound&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;upperBound&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_2/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;transform_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;get_max_value&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;RECORD&quot;</span><span class="p">}}],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;incremental_filter&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;RECORD&quot;</span><span class="p">,</span> <span class="s2">&quot;increment_df&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">},</span>
                <span class="p">}</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;append&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RECORD&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_2/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h4 id="23-parallel-extraction-with-predicates-recommended">2.3 - Parallel Extraction with Predicates (Recommended)</h4>

<p>This scenario performs the extraction from JDBC source in parallel, useful in contexts where there aren't
numeric, date or timestamp columns to parallelize the extraction:</p>

<ul>
<li><code>partitionColumn</code> - column used to split the extraction (can be of any type).</li>
</ul>

<ul>
<li>This is an adequate example to be followed if there is a column in the data source that is good to be
used as the <code>partitionColumn</code>, specially if these columns are not complying with the scenario 2.2.</li>
</ul>

<p><strong>When this property is used, all predicates to Spark need to be provided, otherwise it will leave data behind.</strong></p>

<p>Bellow, a lakehouse function to generate predicate list automatically, is presented.</p>

<p><strong>By using this function one needs to be careful specially on predicates_query and predicates_add_null variables.</strong></p>

<p><strong>predicates_query:</strong> At the sample below the whole table (<code>select distinct(x) from table</code>) is being considered,
but it is possible to filter using predicates list here, specially if you are applying filter on
transformations spec, and you know entire table won't be necessary, so you can change it to something like this:
<code>select distinct(x) from table where x &gt; y</code>.</p>

<p><strong>predicates_add_null:</strong> One can consider if null on predicates list or not. By default, this property is True.
<strong>Example:</strong> for <code>"partitionColumn": "record"</code></p>

<h5 id="init-load-data-into-the-bronze-bucket-3">Init - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/core/exec_env.html">lakehouse_engine.core.exec_env</a></span> <span class="kn">import</span> <span class="n">ExecEnv</span>
<span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/utils/extraction/jdbc_extraction_utils.html">lakehouse_engine.utils.extraction.jdbc_extraction_utils</a></span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">JDBCExtraction</span><span class="p">,</span>
    <span class="n">JDBCExtractionUtils</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ExecEnv</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">()</span>

<span class="n">partitionColumn</span> <span class="o">=</span> <span class="s2">&quot;my_partition_col&quot;</span>
<span class="n">dbtable</span> <span class="o">=</span> <span class="s2">&quot;my_database.my_table&quot;</span>

<span class="n">predicates_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;(SELECT DISTINCT(</span><span class="si">{</span><span class="n">partitionColumn</span><span class="si">}</span><span class="s2">) FROM </span><span class="si">{</span><span class="n">dbtable</span><span class="si">}</span><span class="s2">)&quot;&quot;&quot;</span>
<span class="n">column_for_predicates</span> <span class="o">=</span> <span class="n">partitionColumn</span>
<span class="n">user</span> <span class="o">=</span> <span class="s2">&quot;my_user&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;my_sap_b4_url&quot;</span>
<span class="n">driver</span> <span class="o">=</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span>
<span class="n">predicates_add_null</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">jdbc_util</span> <span class="o">=</span> <span class="n">JDBCExtractionUtils</span><span class="p">(</span>
    <span class="n">JDBCExtraction</span><span class="p">(</span>
        <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">predicates_add_null</span><span class="o">=</span><span class="n">predicates_add_null</span><span class="p">,</span>
        <span class="n">partition_column</span><span class="o">=</span><span class="n">partitionColumn</span><span class="p">,</span>
        <span class="n">dbtable</span><span class="o">=</span><span class="n">dbtable</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">predicates</span> <span class="o">=</span> <span class="n">jdbc_util</span><span class="o">.</span><span class="n">get_predicates</span><span class="p">(</span><span class="n">predicates_query</span><span class="p">)</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;predicates&quot;</span><span class="p">:</span> <span class="n">predicates</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RECORD&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_3/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<h5 id="delta-load-data-into-the-bronze-bucket-4">Delta - Load data into the Bronze Bucket</h5>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/core/exec_env.html">lakehouse_engine.core.exec_env</a></span> <span class="kn">import</span> <span class="n">ExecEnv</span>
<span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/utils/extraction/jdbc_extraction_utils.html">lakehouse_engine.utils.extraction.jdbc_extraction_utils</a></span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">JDBCExtraction</span><span class="p">,</span>
    <span class="n">JDBCExtractionUtils</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ExecEnv</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">()</span>

<span class="n">partitionColumn</span> <span class="o">=</span> <span class="s2">&quot;my_partition_col&quot;</span>
<span class="n">dbtable</span> <span class="o">=</span> <span class="s2">&quot;my_database.my_table&quot;</span>

<span class="n">predicates_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;(SELECT DISTINCT(</span><span class="si">{</span><span class="n">partitionColumn</span><span class="si">}</span><span class="s2">) FROM </span><span class="si">{</span><span class="n">dbtable</span><span class="si">}</span><span class="s2">)&quot;&quot;&quot;</span>
<span class="n">column_for_predicates</span> <span class="o">=</span> <span class="n">partitionColumn</span>
<span class="n">user</span> <span class="o">=</span> <span class="s2">&quot;my_user&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;my_sap_b4_url&quot;</span>
<span class="n">driver</span> <span class="o">=</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span>
<span class="n">predicates_add_null</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">jdbc_util</span> <span class="o">=</span> <span class="n">JDBCExtractionUtils</span><span class="p">(</span>
    <span class="n">JDBCExtraction</span><span class="p">(</span>
        <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">predicates_add_null</span><span class="o">=</span><span class="n">predicates_add_null</span><span class="p">,</span>
        <span class="n">partition_column</span><span class="o">=</span><span class="n">partitionColumn</span><span class="p">,</span>
        <span class="n">dbtable</span><span class="o">=</span><span class="n">dbtable</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">predicates</span> <span class="o">=</span> <span class="n">jdbc_util</span><span class="o">.</span><span class="n">get_predicates</span><span class="p">(</span><span class="n">predicates_query</span><span class="p">)</span>

<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;jdbc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;jdbc_args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;my_sap_b4_url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
                <span class="s2">&quot;predicates&quot;</span><span class="p">:</span> <span class="n">predicates</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;my_user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;my_b4_hana_pwd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;com.sap.db.jdbc.Driver&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fetchSize&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read_type&quot;</span><span class="p">:</span> <span class="s2">&quot;batch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_3/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;transform_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;get_max_value&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;RECORD&quot;</span><span class="p">}}],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transformers&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;incremental_filter&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;input_col&quot;</span><span class="p">:</span> <span class="s2">&quot;RECORD&quot;</span><span class="p">,</span> <span class="s2">&quot;increment_df&quot;</span><span class="p">:</span> <span class="s2">&quot;max_my_identifier_bronze_date&quot;</span><span class="p">},</span>
                <span class="p">}</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">],</span>
    <span class="s2">&quot;output_specs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;spec_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_identifier_bronze&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_id&quot;</span><span class="p">:</span> <span class="s2">&quot;appended_my_identifier&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write_type&quot;</span><span class="p">:</span> <span class="s2">&quot;append&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;delta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;partitions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RECORD&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;s3://my_path/jdbc_template/parallel_3/my_identifier/&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;exec_env&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;spark.databricks.delta.schema.autoMerge.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.optimizeWrite.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spark.databricks.delta.autoCompact.enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>
</div>

    </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>