<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.5.1"/>
    <title>lakehouse_engine_usage.data_quality.custom_expectations</title>
            <link rel="icon" href="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#000000;background-color:#f1efef;border-color:#f1f1f1;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:150%;overflow:auto;margin-bottom:1rem;}.pdoc table th, .pdoc table td{padding:12px 13px;border:1px solid var(--accent2);}.pdoc table th{font-weight:600;}</style>
    <style>/*! custom.css */</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../data_quality.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lakehouse_engine_usage.data_quality</a>

            <img src="https://github.com/adidas/lakehouse-engine/blob/master/assets/img/lakehouse_engine_logo_no_bg_160.png?raw=true" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#custom-expectations">Custom Expectations</a>
  <ul>
    <li><a href="#defining-custom-expectations">Defining Custom Expectations</a></li>
    <li><a href="#creation-process">Creation Process</a></li>
    <li><a href="#usage">Usage</a></li>
    <li><a href="#parameters">Parameters</a></li>
    <li><a href="#result-format">Result Format</a></li>
  </ul></li>
</ul>




            <footer>Lakehouse Engine v1.23.0</footer>

</div>
    </nav>
    <main class="pdoc">
    <section class="module-info">

                <div class="docstring"><h1 id="custom-expectations">Custom Expectations</h1>

<h2 id="defining-custom-expectations">Defining Custom Expectations</h2>

<p>Custom expectations are defined in python and need to follow a structure to correctly integrate with Great Expectations.</p>

<p>Follow the <a href="https://docs.greatexpectations.io/docs/oss/guides/expectations/custom_expectations_lp/">documentation of GX on Creating Custom Expectations</a> 
and find information about <a href="https://docs.greatexpectations.io/docs/conceptual_guides/expectation_classes">the existing types of expectations</a>. </p>

<p>Here is an example of custom expectation.
As for other cases, the acon configuration should be executed with <code>load_data</code> using:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/engine.html">lakehouse_engine.engine</a></span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="n">acon</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="n">load_data</span><span class="p">(</span><span class="n">acon</span><span class="o">=</span><span class="n">acon</span><span class="p">)</span>
</code></pre>
</div>

<p>Example of ACON configuration:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="sd">&quot;&quot;&quot;Expectation to check if column &#39;a&#39; is lower or equal than column &#39;b&#39;.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">great_expectations.core</span> <span class="kn">import</span> <span class="n">ExpectationConfiguration</span>
<span class="kn">from</span> <span class="nn">great_expectations.execution_engine</span> <span class="kn">import</span> <span class="n">ExecutionEngine</span><span class="p">,</span> <span class="n">SparkDFExecutionEngine</span>
<span class="kn">from</span> <span class="nn">great_expectations.expectations.expectation</span> <span class="kn">import</span> <span class="n">ColumnPairMapExpectation</span>
<span class="kn">from</span> <span class="nn">great_expectations.expectations.metrics.map_metric_provider</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ColumnPairMapMetricProvider</span><span class="p">,</span>
    <span class="n">column_pair_condition_partial</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn"><a href="../../lakehouse_engine/utils/expectations_utils.html">lakehouse_engine.utils.expectations_utils</a></span> <span class="kn">import</span> <span class="n">validate_result</span>


<span class="k">class</span> <span class="nc">ColumnPairCustom</span><span class="p">(</span><span class="n">ColumnPairMapMetricProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Asserts that column &#39;A&#39; is lower or equal than column &#39;B&#39;.</span>

<span class="sd">    Additionally, the &#39;margin&#39; parameter can be used to add a margin to the</span>
<span class="sd">    check between column &#39;A&#39; and &#39;B&#39;: &#39;A&#39; &lt;= &#39;B&#39; + &#39;margin&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">condition_metric_name</span> <span class="o">=</span> <span class="s2">&quot;column_pair_values.a_smaller_or_equal_than_b&quot;</span>
    <span class="n">condition_domain_keys</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;batch_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;table&quot;</span><span class="p">,</span>
        <span class="s2">&quot;column_A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;column_B&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_row_if&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">condition_value_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;margin&quot;</span><span class="p">,)</span>

    <span class="nd">@column_pair_condition_partial</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">SparkDFExecutionEngine</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_spark</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">ColumnPairMapMetricProvider</span><span class="p">,</span>
        <span class="n">column_A</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">column_B</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">margin</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the expectation&#39;s logic.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_A: Value of the row of column_A.</span>
<span class="sd">            column_B: Value of the row of column_B.</span>
<span class="sd">            margin: margin value to be added to column_b.</span>
<span class="sd">            kwargs: dict with additional parameters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If the condition is met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">margin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">approx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;margin must be one of int, float, complex.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; Found: </span><span class="si">{</span><span class="n">margin</span><span class="si">}</span><span class="s2"> as </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">margin</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">approx</span> <span class="o">=</span> <span class="n">margin</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">column_A</span> <span class="o">&lt;=</span> <span class="n">column_B</span> <span class="o">+</span> <span class="n">approx</span>  <span class="c1"># type: ignore</span>


<span class="k">class</span> <span class="nc">ExpectColumnPairAToBeSmallerOrEqualThanB</span><span class="p">(</span><span class="n">ColumnPairMapExpectation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Expect values in column A to be lower or equal than column B.</span>

<span class="sd">    Args:</span>
<span class="sd">        column_A: The first column name.</span>
<span class="sd">        column_B: The second column name.</span>
<span class="sd">        margin: additional approximation to column B value.</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        - allow_cross_type_comparisons: If True, allow</span>
<span class="sd">            comparisons between types (e.g. integer and string).</span>
<span class="sd">            Otherwise, attempting such comparisons will raise an exception.</span>
<span class="sd">        - ignore_row_if: &quot;both_values_are_missing&quot;,</span>
<span class="sd">            &quot;either_value_is_missing&quot;, &quot;neither&quot; (default).</span>
<span class="sd">        - result_format: Which output mode to use:</span>
<span class="sd">            `BOOLEAN_ONLY`, `BASIC` (default), `COMPLETE`, or `SUMMARY`.</span>
<span class="sd">        - include_config: If True (default), then include the expectation config</span>
<span class="sd">            as part of the result object.</span>
<span class="sd">        - catch_exceptions: If True, then catch exceptions and</span>
<span class="sd">            include them as part of the result object. Default: False.</span>
<span class="sd">        - meta: A JSON-serializable dictionary (nesting allowed)</span>
<span class="sd">            that will be included in the output without modification.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ExpectationSuiteValidationResult.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">examples</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dataset_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Test Dataset&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
                        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                        <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;schemas&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;spark&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;IntegerType&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;IntegerType&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;IntegerType&quot;</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;tests&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;negative_test&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;exact_match_out&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;include_in_gallery&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;column_A&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;column_B&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;unexpected_index_column_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">],</span>
                        <span class="p">},</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;out&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="s2">&quot;unexpected_index_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
                            <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">},</span>
                            <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;positive_test&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;exact_match_out&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;include_in_gallery&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;column_A&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;column_B&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;margin&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;unexpected_index_column_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
                        <span class="p">},</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;out&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                        <span class="s2">&quot;unexpected_index_list&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="p">},</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">]</span>

    <span class="n">map_metric</span> <span class="o">=</span> <span class="s2">&quot;column_pair_values.a_smaller_or_equal_than_b&quot;</span>
    <span class="n">success_keys</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;column_A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;column_B&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_row_if&quot;</span><span class="p">,</span>
        <span class="s2">&quot;margin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mostly&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">default_kwarg_values</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;mostly&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;ignore_row_if&quot;</span><span class="p">:</span> <span class="s2">&quot;neither&quot;</span><span class="p">,</span>
        <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="s2">&quot;BASIC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;include_config&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;catch_exceptions&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">configuration</span><span class="p">:</span> <span class="n">ExpectationConfiguration</span><span class="p">,</span>
        <span class="n">metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">runtime_configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">execution_engine</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ExecutionEngine</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom implementation of the GE _validate method.</span>

<span class="sd">        This method is used on the tests to validate both the result</span>
<span class="sd">        of the tests themselves and if the unexpected index list</span>
<span class="sd">        is correctly generated.</span>
<span class="sd">        The GE test logic does not do this validation, and thus</span>
<span class="sd">        we need to make it manually.</span>

<span class="sd">        Args:</span>
<span class="sd">            configuration: Configuration used in the test.</span>
<span class="sd">            metrics: Test result metrics.</span>
<span class="sd">            runtime_configuration: Configuration used when running the expectation.</span>
<span class="sd">            execution_engine: Execution Engine where the expectation was run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary with the result of the validation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">validate_result</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">configuration</span><span class="p">,</span>
            <span class="n">metrics</span><span class="p">,</span>
            <span class="n">runtime_configuration</span><span class="p">,</span>
            <span class="n">execution_engine</span><span class="p">,</span>
            <span class="n">ColumnPairMapExpectation</span><span class="p">,</span>
        <span class="p">)</span>


<span class="sd">&quot;&quot;&quot;Mandatory block of code. If it is removed the expectation will not be available.&quot;&quot;&quot;</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># test the custom expectation with the function `print_diagnostic_checklist()`</span>
    <span class="n">ExpectColumnPairAToBeSmallerOrEqualThanB</span><span class="p">()</span><span class="o">.</span><span class="n">print_diagnostic_checklist</span><span class="p">()</span>
</code></pre>
</div>

<h3 id="naming-conventions">Naming Conventions</h3>

<p>Your expectation's name <strong>should</strong> start with expect.</p>

<p>The name of the file <strong>must</strong> be the name of the expectation written in snake case. Ex: <code>expect_column_length_match_input_length</code></p>

<p>The name of the class <strong>must</strong> be the name of the expectation written in camel case. Ex: <code>ExpectColumnLengthMatchInputLength</code></p>

<h3 id="file-structure">File Structure</h3>

<p>The file contains two main sections:</p>

<ul>
<li>the definition of the metric that we are tracking (where we define the logic of the expectation);</li>
<li>the definition of the expectation</li>
</ul>

<h3 id="metric-definition">Metric Definition</h3>

<p>In this section we define the logic of the expectation. This needs to follow a certain structure:</p>

<h4 id="code-structure">Code Structure</h4>

<p>1) The class you define needs to extend one of the Metric Providers defined by Great Expectations that corresponds 
to your expectation's type. More info on the <a href="https://docs.greatexpectations.io/docs/conceptual_guides/metricproviders">metric providers</a>. </p>

<p>2) You need to define the name of your metric. This name <strong>must</strong> be unique and <strong>must</strong> follow the following structure: 
type of expectation.name of metric. Ex.: <code>column_pair_values.a_smaller_or_equal_than_b</code>
<strong>Types of expectations:</strong>  <code>column_values</code>, <code>multicolumn_values</code>, <code>column_pair_values</code>, <code>table_rows</code>, <code>table_columns</code>.</p>

<p>3) Any <a href="#parameters">GX default parameters</a> that are necessary to calculate your metric <strong>must</strong> be defined as "condition_domain_keys".</p>

<p>4) Any <a href="#parameters">additional parameters</a> that are necessary to calculate your metric <strong>must</strong> be defined as "condition_value_keys".</p>

<p>5) The logic of your expectation <strong>must</strong> be defined for the SparkDFExecutionEngine in order to be run on the Lakehouse.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="mi">1</span><span class="p">)</span> <span class="k">class</span> <span class="nc">ColumnMapMetric</span><span class="p">(</span><span class="n">ColumnMapMetricProvider</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Asserts that a column matches a pattern.&quot;&quot;&quot;</span>

    <span class="mi">2</span><span class="p">)</span> <span class="n">condition_metric_name</span> <span class="o">=</span> <span class="s2">&quot;column_pair_values.a_smaller_or_equal_than_b&quot;</span>
    <span class="mi">3</span><span class="p">)</span> <span class="n">condition_domain_keys</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;batch_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;table&quot;</span><span class="p">,</span>
        <span class="s2">&quot;column_A&quot;</span><span class="p">,</span>
        <span class="s2">&quot;column_B&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ignore_row_if&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="mi">4</span><span class="p">)</span> <span class="n">condition_value_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;margin&quot;</span><span class="p">,)</span>

    <span class="mi">5</span><span class="p">)</span> <span class="nd">@column_pair_condition_partial</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">SparkDFExecutionEngine</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_spark</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">ColumnPairMapMetricProvider</span><span class="p">,</span>
        <span class="n">column_A</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">column_B</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">margin</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the expectation&#39;s logic.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_A: Value of the row of column_A.</span>
<span class="sd">            column_B: Value of the row of column_B.</span>
<span class="sd">            margin: margin value to be added to column_b.</span>
<span class="sd">            kwargs: dict with additional parameters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            If the condition is met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">margin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">approx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;margin must be one of int, float, complex.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; Found: </span><span class="si">{</span><span class="n">margin</span><span class="si">}</span><span class="s2"> as </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">margin</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">approx</span> <span class="o">=</span> <span class="n">margin</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">column_A</span> <span class="o">&lt;=</span> <span class="n">column_B</span> <span class="o">+</span> <span class="n">approx</span>  <span class="c1"># type: ignore</span>
</code></pre>
</div>

<h3 id="expectation-definition">Expectation Definition</h3>

<p>In this section we define the expectation. This needs to follow a certain structure:</p>

<h4 id="code-structure-2">Code Structure</h4>

<p>1) The class you define needs to extend one of the Expectations defined by Great Expectations that corresponds to your expectation's type. </p>

<p>2) You must define an "examples" object where you define at least one success and one failure of your expectation to 
demonstrate its logic. The result format must be set to complete, and you must set the <a href="#result-format">unexpected_index_name</a> variable.</p>

<div class="pdoc-alert pdoc-alert-note">

<p>For any examples where you will have unexpected results you must define  unexpected_index_list in your "out" element.
This will be validated during the testing phase.</p>

</div>

<p>3) The metric <strong>must</strong> be the same you defined in the metric definition.</p>

<p>4) You <strong>must</strong> define all <a href="#parameters">additional parameters</a> that the user has to/should provide to the expectation. </p>

<p>5) You <strong>should</strong> define any default values for your expectations parameters. </p>

<p>6) You must <strong>define</strong> the <code>_validate</code> method like shown in the example. You <strong>must</strong> call the <code>validate_result</code> function 
inside your validate method, this process adds a validation to the unexpected index list in the examples.</p>

<div class="pdoc-alert pdoc-alert-note">

<p>If your custom expectation requires any extra validations, or you require additional fields to be returned on 
the final dataframe, you can add them in this function. 
The validate_result method has two optional parameters (<code>partial_success</code> and `partial_result) that can be used to 
pass the result of additional validations and add more information to the result key of the returned dict respectively.</p>

</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="mi">1</span><span class="p">)</span> <span class="k">class</span> <span class="nc">ExpectColumnPairAToBeSmallerOrEqualThanB</span><span class="p">(</span><span class="n">ColumnPairMapExpectation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Expect values in column A to be lower or equal than column B.</span>

<span class="sd">    Args:</span>
<span class="sd">        column_A: The first column name.</span>
<span class="sd">        column_B: The second column name.</span>
<span class="sd">        margin: additional approximation to column B value.</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        allow_cross_type_comparisons: If True, allow</span>
<span class="sd">            comparisons between types (e.g. integer and string).</span>
<span class="sd">            Otherwise, attempting such comparisons will raise an exception.</span>
<span class="sd">        ignore_row_if: &quot;both_values_are_missing&quot;,</span>
<span class="sd">            &quot;either_value_is_missing&quot;, &quot;neither&quot; (default).</span>
<span class="sd">        result_format: Which output mode to use:</span>
<span class="sd">            `BOOLEAN_ONLY`, `BASIC` (default), `COMPLETE`, or `SUMMARY`.</span>
<span class="sd">        include_config: If True (default), then include the expectation config</span>
<span class="sd">            as part of the result object.</span>
<span class="sd">        catch_exceptions: If True, then catch exceptions and</span>
<span class="sd">            include them as part of the result object. Default: False.</span>
<span class="sd">        meta: A JSON-serializable dictionary (nesting allowed)</span>
<span class="sd">            that will be included in the output without modification.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An ExpectationSuiteValidationResult.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="mi">2</span><span class="p">)</span> <span class="n">examples</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dataset_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Test Dataset&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
                <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="p">},</span>
            <span class="s2">&quot;schemas&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;spark&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;IntegerType&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;IntegerType&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;IntegerType&quot;</span><span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;tests&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;negative_test&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;exact_match_out&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;include_in_gallery&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;column_A&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;column_B&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;unexpected_index_column_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;include_unexpected_rows&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                        <span class="p">},</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;out&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="s2">&quot;unexpected_index_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
                            <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">},</span>
                            <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;positive_test&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;exact_match_out&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;include_in_gallery&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;column_A&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;column_B&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;margin&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;unexpected_index_column_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
                        <span class="p">},</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;out&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">]</span>

    <span class="mi">3</span><span class="p">)</span> <span class="n">map_metric</span> <span class="o">=</span> <span class="s2">&quot;column_values.pattern_match&quot;</span>
    <span class="mi">4</span><span class="p">)</span> <span class="n">success_keys</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;validation_regex&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mostly&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="mi">5</span><span class="p">)</span> <span class="n">default_kwarg_values</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ignore_row_if&quot;</span><span class="p">:</span> <span class="s2">&quot;never&quot;</span><span class="p">,</span>
        <span class="s2">&quot;result_format&quot;</span><span class="p">:</span> <span class="s2">&quot;BASIC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;include_config&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;catch_exceptions&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;mostly&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="mi">6</span><span class="p">)</span> <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">configuration</span><span class="p">:</span> <span class="n">ExpectationConfiguration</span><span class="p">,</span>
        <span class="n">metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">runtime_configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">execution_engine</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ExecutionEngine</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom implementation of the GX _validate method.</span>

<span class="sd">        This method is used on the tests to validate both the result</span>
<span class="sd">        of the tests themselves and if the unexpected index list</span>
<span class="sd">        is correctly generated.</span>
<span class="sd">        The GX test logic does not do this validation, and thus</span>
<span class="sd">        we need to make it manually.</span>

<span class="sd">        Args:</span>
<span class="sd">            configuration: Configuration used in the test.</span>
<span class="sd">            metrics: Test result metrics.</span>
<span class="sd">            runtime_configuration: Configuration used when running the expectation.</span>
<span class="sd">            execution_engine: Execution Engine where the expectation was run.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary with the result of the validation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">validate_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configuration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="printing-the-expectation-diagnostics">Printing the Expectation Diagnostics</h3>

<p>Your expectations <strong>must</strong> include the ability to call the Great Expectations diagnostic function in order to be validated.</p>

<p>In order to do this code <strong>must</strong> be present.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="sd">&quot;&quot;&quot;Mandatory block of code. If it is removed the expectation will not be available.&quot;&quot;&quot;</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># test the custom expectation with the function `print_diagnostic_checklist()`</span>
    <span class="n">ExpectColumnPairAToBeSmallerOrEqualThanB</span><span class="p">()</span><span class="o">.</span><span class="n">print_diagnostic_checklist</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="creation-process">Creation Process</h2>

<p>1) Create a branch from lakehouse engine.</p>

<p>2) Create a custom expectation with your specific logic:</p>

<ol>
<li>All new expectations must be placed inside folder <code>/lakehouse_engine/dq_processors/custom_expectations</code>.</li>
<li>The name of the expectation must be added to the file <code>/lakehouse_engine/core/definitions.py</code>, to the variable: <code>CUSTOM_EXPECTATION_LIST</code>.</li>
<li>All new expectations must be tested on <code>/tests/feature/custom_expectations/test_custom_expectations.py</code>.
In order to create a new test for your custom expectation it is necessary to:</li>
</ol>

<ul>
<li>Copy one of the expectation folders in <code>tests/resources/feature/custom_expectations</code> renaming it to your custom expectation.</li>
<li>Make any necessary changes on the data/schema file present.</li>
<li>On <code>/tests/feature/custom_expectations/test_custom_expectations.py</code> add a scenario to test your expectation, all expectations 
must be tested on batch and streaming. The test is implemented to generate an acon based on each scenario data. </li>
<li>Test your developments to check that everything is working as intended.</li>
</ul>

<p>3) When the development is completed, create a pull request with your changes.</p>

<p>4) Your expectation will be available with the next release of the lakehouse engine that happens after you pull request is approved. 
This means that you need to upgrade your version of the lakehouse engine in order to use it.</p>

<h2 id="usage">Usage</h2>

<p>Custom Expectations are available to use like any other expectations provided by Great Expectations.</p>

<h2 id="parameters">Parameters</h2>

<p>Depending on the type of expectation you are defining some parameters are expected by default. 
Ex: A ColumnMapExpectation has a default "column" parameter.</p>

<h3 id="mostly">Mostly</h3>

<p><a href="https://docs.greatexpectations.io/docs/reference/learn/expectations/standard_arguments/#mostly">Mostly</a> is a standard 
parameter for a subset of expectations that is used to define a threshold for the failure of an expectation. 
Ex: A mostly value of 0.7 makes it so that the expectation only fails if more than 70% of records have 
a negative result.</p>

<h2 id="result-format">Result Format</h2>

<p>Great Expectations has several different types of <a href="https://docs.greatexpectations.io/docs/reference/learn/expectations/result_format/">result formats</a> 
for the expectations results. The lakehouse engine requires the result format to be set to "COMPLETE" in order to tag 
the lines where the expectations failed.</p>

<h3 id="unexpected_index_column_names"><code>unexpected_index_column_names</code></h3>

<p>Inside this key you must define what columns are used as an index inside your data. If this is set and the result 
format is set to "COMPLETE" a list with the indexes of the lines that failed the validation will be returned by 
Great Expectations.
This information is used by the Lakehouse Engine to tag the lines in error after the fact. The additional tests 
inside the <code>_validate</code> method verify that the custom expectation is tagging these lines correctly.</p>
</div>

    </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>